<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Binary Mode | ThingSet Protocol Specification</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="apple-touch-icon" sizes="180x180" href="/thingset/branch/v0.3/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/thingset/branch/v0.3/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/thingset/branch/v0.3/favicons/favicon-16x16.png">
    <link rel="manifest" href="/thingset/branch/v0.3/favicons/site.webmanifest">
    <link rel="mask-icon" href="/thingset/branch/v0.3/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/thingset/branch/v0.3/favicons/favicon.ico">
    <meta name="description" content="The ThingSet protocol provides a consistent, standardized way to configure, monitor and control ressource-constrained devices via different communication interfaces like Serial, LoRa, USB, Bluetooth or CAN.">
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <link rel="preload" href="/thingset/branch/v0.3/assets/css/0.styles.447584f3.css" as="style"><link rel="preload" href="/thingset/branch/v0.3/assets/js/app.2321b44e.js" as="script"><link rel="preload" href="/thingset/branch/v0.3/assets/js/2.f2708eff.js" as="script"><link rel="preload" href="/thingset/branch/v0.3/assets/js/3.13f489f1.js" as="script"><link rel="preload" href="/thingset/branch/v0.3/assets/js/15.0b7e21bd.js" as="script"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/10.915ff560.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/11.dae0e5a3.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/12.0554aa46.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/13.33e26227.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/14.a450a7a5.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/16.8b9966f6.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/17.205deb93.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/18.e073e85c.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/19.f53f9684.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/20.1da2538e.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/21.681d2cac.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/22.dcc20910.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/23.b35cdc9f.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/24.3f39481e.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/25.5a098a54.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/26.b1fafc17.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/27.68a8085c.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/28.d0c806db.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/4.56c6f835.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/5.8a67c5b8.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/6.a7d05319.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/7.b3286659.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/8.7f13d3f3.js"><link rel="prefetch" href="/thingset/branch/v0.3/assets/js/9.3133ce9e.js">
    <link rel="stylesheet" href="/thingset/branch/v0.3/assets/css/0.styles.447584f3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/thingset/branch/v0.3/" class="home-link router-link-active"><img src="/thingset/branch/v0.3/favicons/apple-touch-icon.png" alt="ThingSet Protocol Specification" class="logo"> <span class="site-name">ThingSet Protocol Specification</span></a> <div class="links"><div class="search-box can-hide"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="History Menu" class="dropdown-title"><span class="title">History</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.3/" class="nav-link">
  v0.3
</a></li><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.3/v0.2/" class="nav-link">
  v0.2
</a></li><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.3/v0.1/" class="nav-link">
  v0.1
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="History Menu" class="dropdown-title"><span class="title">History</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.3/" class="nav-link">
  v0.3
</a></li><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.3/v0.2/" class="nav-link">
  v0.2
</a></li><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.3/v0.1/" class="nav-link">
  v0.1
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Why ThingSet?</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/branch/v0.3/" class="sidebar-link">Introduction</a></li><li><a href="/thingset/branch/v0.3/1b_existing_solutions.html" class="sidebar-link">Existing Standards</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Application Layer</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/branch/v0.3/2a_general.html" class="sidebar-link">General Concept</a></li><li><a href="/thingset/branch/v0.3/2b_text_mode.html" class="sidebar-link">Text Mode</a></li><li><a href="/thingset/branch/v0.3/2c_binary_mode.html" class="active sidebar-link">Binary Mode</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/thingset/branch/v0.3/2c_binary_mode.html#name-and-id-mapping" class="sidebar-link">Name and ID mapping</a></li><li class="sidebar-sub-header"><a href="/thingset/branch/v0.3/2c_binary_mode.html#read-data" class="sidebar-link">Read data</a></li><li class="sidebar-sub-header"><a href="/thingset/branch/v0.3/2c_binary_mode.html#update-data" class="sidebar-link">Update data</a></li><li class="sidebar-sub-header"><a href="/thingset/branch/v0.3/2c_binary_mode.html#create-data" class="sidebar-link">Create data</a></li><li class="sidebar-sub-header"><a href="/thingset/branch/v0.3/2c_binary_mode.html#delete-data" class="sidebar-link">Delete data</a></li><li class="sidebar-sub-header"><a href="/thingset/branch/v0.3/2c_binary_mode.html#execute-function" class="sidebar-link">Execute function</a></li><li class="sidebar-sub-header"><a href="/thingset/branch/v0.3/2c_binary_mode.html#other-functions" class="sidebar-link">Other functions</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Lower Layers</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/branch/v0.3/3a_serial.html" class="sidebar-link">Serial</a></li><li><a href="/thingset/branch/v0.3/3b_can.html" class="sidebar-link">CAN</a></li><li><a href="/thingset/branch/v0.3/3c_lora.html" class="sidebar-link">LoRa</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Protocol Mapping</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/branch/v0.3/4a_http.html" class="sidebar-link">HTTP</a></li><li><a href="/thingset/branch/v0.3/4b_coap.html" class="sidebar-link">CoAP</a></li><li><a href="/thingset/branch/v0.3/4c_mqtt.html" class="sidebar-link">MQTT</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="binary-mode"><a href="#binary-mode" class="header-anchor">#</a> Binary Mode</h1> <p>In the binary mode, the data is encoded using the CBOR format. The data structure is the same as in text mode, but numeric node IDs are used as identifiers by default instead of the node names.</p> <p>The length of the entire request or response is not encoded in the ThingSet protocol, but can be determined from the CBOR format. Packet length as well as checksums should be encoded in lower layer protocols. It is assumed that the parser always receives a complete request.</p> <h3 id="requests"><a href="#requests" class="header-anchor">#</a> Requests</h3> <p>Each request message consists of a first byte as the request method identifier, a path or ID specifying the endpoint of the request and CBOR data as payload (if applicable).</p> <div class="language- extra-class"><pre><code>bin-request = bin-get / bin-post / bin-delete / bin-fetch / bin-ipatch / bin-nameid

bin-get    = %x01 endpoint get-type

bin-post   = %x02 endpoint cbor-data      ; exec or create is determined
                                          ; based on node type

bin-delete = %x04 endpoint cbor-uint      ; only for valid node IDs

bin-fetch  = %x05 endpoint cbor-array     ; returns only values, no keys

bin-ipatch = %x07 endpoint cbor-map

bin-nameid = %x1E endpoint cbor-array     ; get names of ids or vice versa

endpoint   = path         ; CBOR string: path same as text mode
           / parent-id    ; CBOR uint: parent node ID instead of path
           / %xF7         ; CBOR undefined: wildcard matching any path / parent

get-type   = %xF7         ; CBOR undefined: returns array of node IDs (default)
           / %x80         ; CBOR emtpy array: returns array of names
           / %xA0         ; CBOR empty map: returns name:value map
</code></pre></div><h3 id="response"><a href="#response" class="header-anchor">#</a> Response</h3> <p>Responses in binary mode start with the error/status code as specified before, followed by the data if applicable.</p> <div class="language- extra-class"><pre><code>bin-response = %x80-FF [ cbor-data ]      ; response code and data
</code></pre></div><h3 id="publication-message"><a href="#publication-message" class="header-anchor">#</a> Publication message</h3> <p>Binary publication messages follow the same concept as in text mode.</p> <div class="language- extra-class"><pre><code>bin-pubmsg = %x1F bin-topic cbor-map      ; map containing node IDs and values

bin-topic = cbor-string                   ; empty string 0x60 if not specified
</code></pre></div><h2 id="name-and-id-mapping"><a href="#name-and-id-mapping" class="header-anchor">#</a> Name and ID mapping</h2> <p>The examples in this chapter are based on the same data structure as introduced in the <a href="/thingset/branch/v0.3/2a_general.html#data-structure">General Concept chapter</a>, but each node is identified by an ID. The assignment of IDs and names is shown in the following JSON-like structure (actual JSON supports neither numbers as keys nor comments):</p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;18&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                             <span class="token comment">// info</span>
        <span class="token property">&quot;19&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MPPT 1210 HUS&quot;</span><span class="token punctuation">,</span>          <span class="token comment">// DeviceType</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;30&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                             <span class="token comment">// conf</span>
        <span class="token property">&quot;31&quot;</span><span class="token operator">:</span> <span class="token number">14.4</span><span class="token punctuation">,</span>                     <span class="token comment">// BatCharging_V</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;60&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                             <span class="token comment">// input</span>
        <span class="token property">&quot;61&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>                      <span class="token comment">// EnableCharging</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;70&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                             <span class="token comment">// output</span>
        <span class="token property">&quot;71&quot;</span><span class="token operator">:</span> <span class="token number">14.1</span><span class="token punctuation">,</span>                     <span class="token comment">// Bat_V</span>
        <span class="token property">&quot;72&quot;</span><span class="token operator">:</span> <span class="token number">5.13</span><span class="token punctuation">,</span>                     <span class="token comment">// Bat_A</span>
        <span class="token property">&quot;73&quot;</span><span class="token operator">:</span> <span class="token number">22</span>                        <span class="token comment">// Ambient_degC</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;A0&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                             <span class="token comment">// rec</span>
        <span class="token property">&quot;A1&quot;</span><span class="token operator">:</span> <span class="token number">1984</span><span class="token punctuation">,</span>                     <span class="token comment">// BatChgDay_Wh</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;D0&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                             <span class="token comment">// cal</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;E0&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                             <span class="token comment">// exec</span>
        <span class="token property">&quot;E1&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>                     <span class="token comment">// reset</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;EF&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Password&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                 <span class="token comment">// auth</span>
    <span class="token property">&quot;F0&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                             <span class="token comment">// pub</span>
        <span class="token property">&quot;F1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                         <span class="token comment">// serial</span>
            <span class="token property">&quot;F2&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                 <span class="token comment">// Enable</span>
            <span class="token property">&quot;F3&quot;</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>                  <span class="token comment">// Interval</span>
            <span class="token property">&quot;F4&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;71&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;72&quot;</span><span class="token punctuation">]</span>          <span class="token comment">// IDs</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;F5&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                         <span class="token comment">// can</span>
            <span class="token property">&quot;F6&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>                <span class="token comment">// Enable</span>
            <span class="token property">&quot;F7&quot;</span><span class="token operator">:</span> <span class="token number">0.1</span><span class="token punctuation">,</span>                  <span class="token comment">// Interval</span>
            <span class="token property">&quot;F8&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;71&quot;</span><span class="token punctuation">]</span>                <span class="token comment">// IDs</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The firmware developer is free to choose the IDs. However, above IDs for the nodes of the first layer are used by Libre Solar devices and recommended for the following reasons:</p> <ul><li>IDs from 0x00 to 0x17 are left for data nodes that are sent very often, as they consume only a single byte in CBOR encoding</li> <li>The node IDs specifying the categories are spaced such that there should be enough free node IDs for most devices</li> <li>As the node IDs are strictly increasing, the data layot is compatible with the draft standard <a href="https://tools.ietf.org/html/draft-ietf-core-yang-cbor" target="_blank" rel="noopener noreferrer">CBOR Encoding of Data Modeled with YANG<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ul> <p>In contrast to the text mode, the binary mode has a special NAMEID request (without CoAP equivalent) that allows to get a name for an ID or vice versa.</p> <p><strong>Example 1:</strong> Request name of node IDs 0x71 and 0x72</p> <div class="language- extra-class"><pre><code>Request:
1E                                      NAMEID request
   18 70                                # CBOR uint: 0x70 (parent ID)
   82                                   # CBOR array (2 elements)
      18 71                             # CBOR uint: 0x71 (node ID)
      18 72                             # CBOR uint: 0x72 (node ID)

Response:
85                                      Content.
   82                                   # CBOR array (2 elements)
      65 4261745F56                     # CBOR string: &quot;Bat_V&quot;
      65 4261745F41                     # CBOR string: &quot;Bat_A&quot;
</code></pre></div><p>If the parent ID is passed as the endpoint, only the data node name is returned. All requested nodes must be children of the same parend node in this case.</p> <p><strong>Example 2:</strong> Request full path of node ID 0x71 (Bat_V)</p> <div class="language- extra-class"><pre><code>Request:
1E                                      NAMEID request
   F7                                   # CBOR undefined as a wildcard
   18 71                                # CBOR uint: 0x71 (node ID)

Response:
85                                      Content.
   6C 6F75747075742F4261745F56          # CBOR string: &quot;output/Bat_V&quot;
</code></pre></div><p>If the path of a node is unknown (e.g. because it was obtained from a publication message), the entire path (see text mode) can be determined by setting the endpoint to undefined, as shown above.</p> <p><strong>Example 3:</strong> Request IDs for known data node names</p> <div class="language- extra-class"><pre><code>Request:
1E                                      NAMEID request
   F7                                   # CBOR undefined as a wildcard
   82                                   # CBOR array (2 elements)
      65 4261745F56                     # CBOR string: &quot;Bat_V&quot;
      65 4261745F41                     # CBOR string: &quot;Bat_A&quot;

Response:
85                                      Content.
   82                                   # CBOR array (2 elements)
      18 71                             # CBOR uint: 0x71 (node ID)
      18 72                             # CBOR uint: 0x72 (node ID)
</code></pre></div><p>Also here a wildcard for the endpoint can be used to query the entire database. However, if multiple nodes with the same name are found, an error must be returned. This should not be the case for a properly designed data structure.</p> <h2 id="read-data"><a href="#read-data" class="header-anchor">#</a> Read data</h2> <p>Similar to the text mode, the binary variants of the GET and FETCH functions also allow to read one or more data objects. The objects are identified by their parent node (endpoint of a path) and their ID or their name.</p> <p>The GET function is useful for device discovery, as it can list all childs of a node. Depending on the computing power of the device and the host, the GET request can either return only the IDs of the next layer or maps including the values. In order to be compatible to the text mode, it is also possible to retrieve all child nodes of a resource as a map of name/value pairs.</p> <p>The binary mode also allows to work only with IDs and no paths or node names to keep message size at a minimum. In order to discover the nodes of a device, the host can first query all child IDs of a node (starting with root node of ID 0), afterwards query the names for each ID once and then request the value for any data object on demand.</p> <p><strong>Example 1:</strong> Discover all child nodes of the root node (i.e. categories)</p> <div class="language- extra-class"><pre><code>Request:
01                                      GET request
   00                                   # CBOR uint: 0x00 (root node)
   F7                                   # CBOR undefined as a wildcard

Response:
85                                      Content.
   89                                   # CBOR array (9 elements)
      18 18                             # CBOR uint: 0x18
      18 30                             # CBOR uint: 0x30
       ...
      18 F0                             # CBOR data: 0xF0
</code></pre></div><p><strong>Example 2:</strong> Retrieve all data of output path (keys + values)</p> <div class="language- extra-class"><pre><code>Request (alternative 1):
01                                      GET request
   18 70                                # CBOR uint: 0x70
   A0                                   # CBOR empty map

Request (alternative 2):
01                                      GET request
   66 6F7574707574                      # CBOR string: &quot;output&quot;
   A0                                   # CBOR empty map

Response:
85                                      Content.
   A3                                   # CBOR map (3 elements)
      65 4261745F56                     # CBOR string: &quot;Bat_V&quot;
      FA 4161999A                       # CBOR float: 14.1
      65 4261745F41                     # CBOR string: &quot;Bat_A&quot;
      FA 40A428F6                       # CBOR float: 5.13
      6C 416D6269656E745F64656743       # CBOR string: &quot;Ambient_degC&quot;
      16                                # CBOR uint: 22
</code></pre></div><p>Note that the empty map requests to respond with name/value pairs as specified in the request grammar at the beginning of the chapter.</p> <p><strong>Example 3:</strong> Retrieve value of data node &quot;Bat_V&quot;</p> <div class="language- extra-class"><pre><code>Request (alternative 1):
05                                      FETCH request
   66 6F7574707574                      # CBOR string: &quot;output&quot; (path)
   65 4261745F56                        # CBOR string: &quot;Bat_V&quot; (node name)

Request (alternative 2):
05                                      FETCH request
   18 70                                # CBOR uint: 0x70 (parent ID)
   18 71                                # CBOR uint: 0x71 (node ID)

Response:
85                                      Content.
   FA 4161999A                          # CBOR float: 14.1
</code></pre></div><p><strong>Example 4:</strong> Retrieve multiple data nodes:</p> <div class="language- extra-class"><pre><code>Request:
05                                      FETCH request
   18 70                                # CBOR uint: 0x70 (parent ID)
   82                                   # CBOR array (2 elements)
      18 71                             # CBOR uint: 0x71 (node ID)
      18 72                             # CBOR uint: 0x72 (node ID)

Response:
85                                      Content.
   82                                   # CBOR array (2 elements)
      FA 4161999A                       # CBOR float: 14.1
      16                                # CBOR uint: 22
</code></pre></div><p>The binary mode also allows to use data object names (strings) instead of numeric IDs, which increases the amount of transferred data.</p> <h2 id="update-data"><a href="#update-data" class="header-anchor">#</a> Update data</h2> <p>Requests to overwrite the value a data node.</p> <p>The device must support a patch request using the same CBOR data type as used in the response of a GET or FETCH request for the given objects. Optionally, the device may also accept different data types (e.g. float32 instead of int) and convert the data internally.</p> <p>If the data type is not supported, an error status code (36) is responded.</p> <p><strong>Example 1:</strong> Disable charging</p> <div class="language- extra-class"><pre><code>Request:
07                                      PATCH request
   18 70                                # CBOR uint: 0x70
   A1                                   # CBOR map (1 element)
      18 61                             # CBOR uint: 0x61
      F4                                # CBOR data: false

Response:
84                                      Changed.
</code></pre></div><p><strong>Example 2:</strong> Attempt to write read-only measurement values (output category)</p> <div class="language- extra-class"><pre><code>Request:
07                                      PATCH request
   A2                                   # CBOR map (2 elements)
      18 71                             # CBOR uint: 0x71
      FA 0x41633333                     # CBOR float32: 14.2
      18 73                             # CBOR uint: 0x73
      16                                # CBOR uint: 22

Response:
A3                                      Forbidden.
</code></pre></div><h2 id="create-data"><a href="#create-data" class="header-anchor">#</a> Create data</h2> <p>Appends new data to a data node in a similar way as in the text mode.</p> <p><strong>Example 1:</strong> Add node ID 0x72 (Bat_A) to the serial publication channel</p> <div class="language- extra-class"><pre><code>Request:
02                                      POST request
   18 F4                                # CBOR uint: 0xF4 (parent ID)
   18 72                                # CBOR uint: 0x72 (node ID)

Response:
81                                      Created.
</code></pre></div><h2 id="delete-data"><a href="#delete-data" class="header-anchor">#</a> Delete data</h2> <p>Removes data from a node of array type.</p> <p><strong>Example 1:</strong> Remove node ID 0x72 (Bat_A) from serial publication channel</p> <div class="language- extra-class"><pre><code>Request:
04                                      DELETE request
   18 F4                                # CBOR uint: 0xF4 (parent ID)
   18 72                                # CBOR uint: 0x72 (node ID)

Response:
82                                      Deleted.
</code></pre></div><h2 id="execute-function"><a href="#execute-function" class="header-anchor">#</a> Execute function</h2> <p>For execution of a function, the same POST request is used as when creating data. The device decides based on the type of the endpoint whether the request is a function call or a request to create data.</p> <p><strong>Example 1:</strong> Reset the device</p> <div class="language- extra-class"><pre><code>Request:
02                                      POST request
   18 E1                                # CBOR uint: 0xE1 (node ID)
   80                                   # CBOR empty array

Response:
83                                      Valid.
</code></pre></div><p>Note that the endpoint is the node of the executable function itself. Data can be passed to the called function as the second parameter, but the &quot;reset&quot; function does not require any parameters, so it receives an empty array.</p> <h2 id="other-functions"><a href="#other-functions" class="header-anchor">#</a> Other functions</h2> <p>Authentication, publication request setup and publication messages work analog to text mode.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/20/2020, 6:04:34 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/thingset/branch/v0.3/2b_text_mode.html" class="prev">
        Text Mode
      </a></span> <span class="next"><a href="/thingset/branch/v0.3/3a_serial.html">
        Serial
      </a>
      →
    </span></p></div>  <div class="footer">
    Content provided by <a href="https://libre.solar">Libre Solar</a> under <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">CC-BY-SA 4.0 License</a> | <a href="https://libre.solar/about/contact/">Contact / Impressum</a></div></main></div><div class="global-ui"></div></div>
    <script src="/thingset/branch/v0.3/assets/js/app.2321b44e.js" defer></script><script src="/thingset/branch/v0.3/assets/js/2.f2708eff.js" defer></script><script src="/thingset/branch/v0.3/assets/js/3.13f489f1.js" defer></script><script src="/thingset/branch/v0.3/assets/js/15.0b7e21bd.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"><link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5"><link rel="shortcut icon" href="/favicons/favicon.ico"><meta name="msapplication-TileColor" content="#2b5797"><meta name="msapplication-config" content="/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><title>Data Structure | ThingSet</title><meta name="description" content="The Data Accessibility Framework"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.23">
    <link rel="preload" href="/branch/bin-record-support/assets/js/runtime~app.35fb79fa.js" as="script"><link rel="preload" href="/branch/bin-record-support/assets/css/styles.4a117ca0.css" as="style"><link rel="preload" href="/branch/bin-record-support/assets/js/9296.89757b8c.js" as="script"><link rel="preload" href="/branch/bin-record-support/assets/js/app.5aec81c2.js" as="script">
    <link rel="stylesheet" href="/branch/bin-record-support/assets/css/styles.4a117ca0.css">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/branch/bin-record-support/" class=""><img class="logo" src="/branch/bin-record-support/images/thingset-logo.png" alt="ThingSet"><span class="site-name can-hide">ThingSet</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Software"><span class="title">Software</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Software"><span class="title">Software</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/branch/bin-record-support/software/node_library" class="nav-link" aria-label="Node Library"><!--[--><!--]--> Node Library <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/software/zephyr_sdk" class="nav-link" aria-label="SDK for Zephyr"><!--[--><!--]--> SDK for Zephyr <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/software/app" class="nav-link" aria-label="Mobile App"><!--[--><!--]--> Mobile App <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.6/introduction/abstract" class="nav-link" aria-label="v0.6"><!--[--><!--]--> v0.6 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.5/introduction" class="nav-link" aria-label="v0.5"><!--[--><!--]--> v0.5 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.4/introduction" class="nav-link" aria-label="v0.4"><!--[--><!--]--> v0.4 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.3/1a_introduction" class="nav-link" aria-label="v0.3"><!--[--><!--]--> v0.3 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.2/1a_introduction" class="nav-link" aria-label="v0.2"><!--[--><!--]--> v0.2 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.1/" class="nav-link" aria-label="v0.1"><!--[--><!--]--> v0.1 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/changelog" class="nav-link" aria-label="Changelog"><!--[--><!--]--> Changelog <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Software"><span class="title">Software</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Software"><span class="title">Software</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/branch/bin-record-support/software/node_library" class="nav-link" aria-label="Node Library"><!--[--><!--]--> Node Library <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/software/zephyr_sdk" class="nav-link" aria-label="SDK for Zephyr"><!--[--><!--]--> SDK for Zephyr <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/software/app" class="nav-link" aria-label="Mobile App"><!--[--><!--]--> Mobile App <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.6/introduction/abstract" class="nav-link" aria-label="v0.6"><!--[--><!--]--> v0.6 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.5/introduction" class="nav-link" aria-label="v0.5"><!--[--><!--]--> v0.5 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.4/introduction" class="nav-link" aria-label="v0.4"><!--[--><!--]--> v0.4 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.3/1a_introduction" class="nav-link" aria-label="v0.3"><!--[--><!--]--> v0.3 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.2/1a_introduction" class="nav-link" aria-label="v0.2"><!--[--><!--]--> v0.2 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/v0.1/" class="nav-link" aria-label="v0.1"><!--[--><!--]--> v0.1 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-record-support/spec/changelog" class="nav-link" aria-label="Changelog"><!--[--><!--]--> Changelog <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">Why ThingSet?</p><ul class=""><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/introduction.html" class="nav-link sidebar-item" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/existing_solutions.html" class="nav-link sidebar-item" aria-label="Existing Solutions"><!--[--><!--]--> Existing Solutions <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item active">Application Layer</p><ul class=""><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/appl_general_concept.html" class="nav-link sidebar-item" aria-label="General Concept"><!--[--><!--]--> General Concept <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-record-support/spec/v0.5/appl_data_structure.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="Data Structure"><!--[--><!--]--> Data Structure <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/branch/bin-record-support/spec/v0.5/appl_data_structure.html#names-and-ids" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Names and IDs"><!--[--><!--]--> Names and IDs <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-record-support/spec/v0.5/appl_data_structure.html#example-data" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Example Data"><!--[--><!--]--> Example Data <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/appl_access_functions.html" class="nav-link sidebar-item" aria-label="Access Functions"><!--[--><!--]--> Access Functions <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/appl_text_mode.html" class="nav-link sidebar-item" aria-label="Text Mode"><!--[--><!--]--> Text Mode <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/appl_binary_mode.html" class="nav-link sidebar-item" aria-label="Binary Mode"><!--[--><!--]--> Binary Mode <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Transport Layers</p><ul class=""><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/transp_serial.html" class="nav-link sidebar-item" aria-label="Serial"><!--[--><!--]--> Serial <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/transp_websocket.html" class="nav-link sidebar-item" aria-label="WebSocket"><!--[--><!--]--> WebSocket <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/transp_can.html" class="nav-link sidebar-item" aria-label="CAN"><!--[--><!--]--> CAN <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/transp_lorawan.html" class="nav-link sidebar-item" aria-label="LoRaWAN"><!--[--><!--]--> LoRaWAN <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/transp_ble.html" class="nav-link sidebar-item" aria-label="BLE"><!--[--><!--]--> BLE <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Protocol Mapping</p><ul class=""><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/mapping_http.html" class="nav-link sidebar-item" aria-label="HTTP"><!--[--><!--]--> HTTP <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/mapping_coap.html" class="nav-link sidebar-item" aria-label="CoAP"><!--[--><!--]--> CoAP <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/mapping_mqtt.html" class="nav-link sidebar-item" aria-label="MQTT"><!--[--><!--]--> MQTT <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Tools</p><ul class=""><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/tools_serial.html" class="nav-link sidebar-item" aria-label="Serial"><!--[--><!--]--> Serial <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-record-support/spec/v0.5/tools_can.html" class="nav-link sidebar-item" aria-label="CAN bus"><!--[--><!--]--> CAN bus <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="data-structure" tabindex="-1"><a class="header-anchor" href="#data-structure" aria-hidden="true">#</a> Data Structure</h1><p>All accessible data of a device is <a href="https://en.wikipedia.org/wiki/Tree_(data_structure)" target="_blank" rel="noopener noreferrer">structured as a tree<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>. The nodes in the tree structure are called <strong>data objects</strong> and correspond to the JSON object definition.</p><p>Inner nodes in the structure are used to define the hierarchical structure of the data.</p><p>Actual data is stored in leaf nodes, called <strong>data items</strong>. The data items can contain any kind of measurements (e.g. temperature), device configuration (e.g. setpoint of a controller) or similar information.</p><h2 id="names-and-ids" tabindex="-1"><a class="header-anchor" href="#names-and-ids" aria-hidden="true">#</a> Names and IDs</h2><p>Each data object in the tree is identified by a numeric ID and a name. The ID can be chosen by the firmware developer. The name is a short case-sensitive ASCII string containing only alphanumeric characters and underscores without any whitespace characters.</p><p>An underscore as the first character is used to identify paths which are used internally by the protocol itself (e.g. configuration of publication messages).</p><p>If used in the middle of the name, an underscore separates the description of the item and the unit (also see below). No additional underscores are allowed in the name.</p><p>By convention, data items (leaf nodes) use <a href="https://en.wikipedia.org/wiki/Camel_case" target="_blank" rel="noopener noreferrer">lower camel case<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> for their names where the first character is a prefix as defined below. Inner objects to define a path use upper camel case names.</p><p>The IDs must be unique per device. However, there may be multiple data items with the same name if they are located in different paths in the data hierarchy.</p><p>The IDs are used to access data objects in the binary protocol mode for reduced message size. They can also be used in the firmware to define the relations in the data structure. For all interactions with users and in the text-based mode, only the object names and paths are used.</p><p>Data object IDs are stored as unsigned integers. The firmware developer should assign the lowest IDs to the most used data objects, as they consume less bytes during transfer (see CBOR representation of unsigned integers).</p><h3 id="item-type-prefixes" tabindex="-1"><a class="header-anchor" href="#item-type-prefixes" aria-hidden="true">#</a> Item type prefixes</h3><p>Each data item is prefixed with a single character to identify its type according to below tables.</p><h4 id="normal-items" tabindex="-1"><a class="header-anchor" href="#normal-items" aria-hidden="true">#</a> Normal items</h4><table><thead><tr><th>Prefix</th><th>Read</th><th>Write</th><th>TSDB</th><th>Description</th></tr></thead><tbody><tr><td>c</td><td>yes</td><td>no</td><td>no</td><td>constant value (not changed during operation)</td></tr><tr><td>r</td><td>yes</td><td>no</td><td>yes</td><td>read-only value (e.g. measurement, state)</td></tr><tr><td>w</td><td>yes</td><td>yes</td><td>yes</td><td>write-able value (e.g. control input, stored in RAM)</td></tr><tr><td>p</td><td>yes</td><td>yes</td><td>yes</td><td>protected value (reset-able, normally only read)</td></tr><tr><td>s</td><td>yes</td><td>yes</td><td>no</td><td>stored value (in non-volatile memory, typically config)</td></tr><tr><td>t</td><td>yes</td><td>maybe</td><td>yes</td><td>timestamp (dedicated prefix to reduce processing effort)</td></tr><tr><td>z</td><td>yes</td><td>yes</td><td>yes</td><td>control values (reserved for future use)</td></tr></tbody></table><p>The TSDB column marks types which are suitable for storage in a time-series database (TSDB) because they may change dynamically over time (typically measurements or states). The other types are used for more static data like configuration values.</p><p>The functions to read, write and execute a data item will be explained in the next chapter.</p><p>Changes to write-able data items (prefix <code>w</code>) are only stored in RAM, so they get lost after a reset of the device. In contrast to that, stored data (prefix <code>s</code>) is stored in non-volatile memory (e.g. flash or EEPROM) after a change. As non-volatile memory has a limited amount of write cycles, configuration data should not be changed continuously.</p><p>Factory calibration data items are only accessible for the manufacturer after authentication. If the user should be able to reset a value (e.g. a min/max counter), the value would be prefixed with <code>p</code> for protected. It is up to the firmware developer how the value should be protected. It may also only be marked differently to a normal input value (<code>w</code>) in a user interface.</p><h4 id="subsets" tabindex="-1"><a class="header-anchor" href="#subsets" aria-hidden="true">#</a> Subsets</h4><p>Subset items contain an array pointing at existing data items. They can be used to configure the content of statements for publication if data objects of different groups should be combined in a single message.</p><p>Three different types of subsets can be defined depending on their prefix.</p><table><thead><tr><th>Prefix</th><th>TSDB</th><th>Description</th></tr></thead><tbody><tr><td>a</td><td>no</td><td>attribute subset (only published on request)</td></tr><tr><td>e</td><td>maybe</td><td>event subset (only published if changed/updated)</td></tr><tr><td>m</td><td>yes</td><td>metrics subset (published in regular time intervals)</td></tr></tbody></table><p>The subset names can consist only of the prefix. If only one subset for metrics is required, the name can be <code>m</code>.</p><h4 id="executable-items-and-parameters" tabindex="-1"><a class="header-anchor" href="#executable-items-and-parameters" aria-hidden="true">#</a> Executable items and parameters</h4><p>Excecutable data means that they trigger a function call in the device firmware. Child objects of the executable object can be used internally to define parameters that can be passed to the function.</p><table><thead><tr><th>Prefix</th><th>Description</th></tr></thead><tbody><tr><td>x</td><td>executable item (name can be read, parameters write-only)</td></tr></tbody></table><p>The data types of function parameters for executable items cannot be determined, as the values cannot be read. For this reason, special prefixes to define the data type according to below table are used:</p><table><thead><tr><th>Prefix</th><th>Description</th></tr></thead><tbody><tr><td>n</td><td>natural number (unsigned)</td></tr><tr><td>i</td><td>integer</td></tr><tr><td>f</td><td>floating-point number</td></tr><tr><td>l</td><td>logic value (boolean)</td></tr><tr><td>b</td><td>binary data (base-64 encoded)</td></tr><tr><td>u</td><td>utf8-string</td></tr></tbody></table><h4 id="records" tabindex="-1"><a class="header-anchor" href="#records" aria-hidden="true">#</a> Records</h4><p>It is not always feasible to statically assign IDs for all data items at compile-time:</p><ul><li>Where the data follows a pattern but the size of the pattern is not known in advance, e.g. log events, a modular system of N modules, or a multi-channel sensor/ADC input where each channel has the same configuration structure.</li><li>If a device is trying to expose data from one or more connected devices (i.e. a protocol bridge)</li></ul><p>Records are a collection of arbitrary key/value pairs of data (JSON objects) stored as elements of an array. The individual records can be accessed using their index in the array (starting at 0). Only entire records can be addressed. It is not possible to read or change individual items which are part of a record.</p><p>The same items in different records share their IDs. This allows to use IDs instead of names in the binary protocol, but only the class/type of items has to be known in advance, not the number of items.</p><p>It is not required that all records of one data object have the same data structure. However, using the same <code>struct</code> for all records would be most easy to implement for lower-level languages like C.</p><p>Data objects to store records don&#39;t have a prefix. Their name is similar to a group. The difference is that records are wrapped in an array of arbitrary length and not directly stored as key/value pairs in a JSON object.</p><h3 id="units" tabindex="-1"><a class="header-anchor" href="#units" aria-hidden="true">#</a> Units</h3><p>Only <a href="https://en.wikipedia.org/wiki/International_System_of_Units" target="_blank" rel="noopener noreferrer">SI units<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> and derived units (e.g. kWh for energy instead of Ws) are allowed.</p><p>The unit is appended to the data item name using an underscore. In order to keep the name very compact, the unit is also used to identify the physical quantity of the value. So instead of &quot;rBatteryEnergy_kWh&quot; a short name like &quot;rBat_kWh&quot; is preferred.</p><p>Some special characters have to be replaced according to the following table in order to be compatible with URIs (see <a href="https://tools.ietf.org/html/rfc3986#section-2.3" target="_blank" rel="noopener noreferrer">RFC 3986, section 2.3<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>):</p><table><thead><tr><th>Character</th><th>Replacement</th><th>Example</th></tr></thead><tbody><tr><td>°</td><td>deg</td><td>&quot;rAmbient_degC&quot; for ambient temperature in °C</td></tr><tr><td>%</td><td>pct</td><td>&quot;rRelHumidity_pct&quot; for relative humidity in %</td></tr><tr><td>/</td><td>_</td><td>&quot;rVeh_m_s&quot; for vehicle speed in m/s</td></tr><tr><td>^</td><td>(omitted)</td><td>&quot;cSurface_m2&quot; for surface area in m^2</td></tr></tbody></table><p>See also the <a href="https://openmanufacturingplatform.github.io/sds-bamm-aspect-meta-model/bamm-specification/2.0.0-M1/appendix/appendix.html#unit-catalog" target="_blank" rel="noopener noreferrer">Open Manufacturing Platform Semantic Data Model<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> for a list of common units and physical quantities.</p><h3 id="reserved-ids" tabindex="-1"><a class="header-anchor" href="#reserved-ids" aria-hidden="true">#</a> Reserved IDs</h3><p>The IDs 0x00 and 0x10-0x1F are reserved for special data objects that need to be known in advance. In addition to that, IDs starting from 0x8000 are reserved for control purposes and will be assigned in the future.</p><p>The following table shows the assigned IDs. Currently unassigned IDs might be defined in a future version of the protocol.</p><table><thead><tr><th>ID</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>0x00</td><td></td><td>Root object of a device</td></tr><tr><td>0x10</td><td>t_s</td><td>Unix timestamp in seconds since Jan 01, 1970</td></tr><tr><td>0x16</td><td>_ids</td><td>Endpoint used by binary protocol to determine IDs from paths</td></tr><tr><td>0x17</td><td>_paths</td><td>Endpoint used by binary protocol to determine paths from IDs</td></tr><tr><td>0x18</td><td>cMetadataURL</td><td>URL to JSON file containing extended information about exposed data</td></tr><tr><td>0x1D</td><td>cNodeID</td><td>Alphanumeric string (without spaces) to identify the device/node (should be unique per manufacturer, typical length 8 characters)</td></tr><tr><td>&gt;=0x8000</td><td>...</td><td>Control data objects with fixed IDs</td></tr></tbody></table><p>The IDs up to 0x17 consume only a single byte when encoded as CBOR, which minimizes space consumption for IDs that are used often. The <code>cMetadataURL</code> is retrieved only once during startup, so it is acceptable to consume 2 bytes for its ID.</p><h2 id="example-data" tabindex="-1"><a class="header-anchor" href="#example-data" aria-hidden="true">#</a> Example Data</h2><h3 id="flat-layout" tabindex="-1"><a class="header-anchor" href="#flat-layout" aria-hidden="true">#</a> Flat layout</h3><p>Most simple valid data layout consists of key/value pairs without any hierarchy.</p><p>The following data layout could be used for a smart heating thermostat that can be configured for a target temperature. The measured temperature and whether the heater is currently on or off can be read from the device.</p><div class="language-json ext-json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;cNodeID&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ABCD1234&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rMeas_degC&quot;</span><span class="token operator">:</span> <span class="token number">18.3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rHeaterOn&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sTarget_degC&quot;</span><span class="token operator">:</span> <span class="token number">22.0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="grouped-layout" tabindex="-1"><a class="header-anchor" href="#grouped-layout" aria-hidden="true">#</a> Grouped layout</h3><p>The following example data structure of an MPPT solar charge controller will be used for further explanation of the protocol.</p><div class="language-json ext-json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;t_s&quot;</span><span class="token operator">:</span> <span class="token number">460677600</span><span class="token punctuation">,</span>                                               <span class="token comment">// 0x10 (fixed)</span>
    <span class="token property">&quot;cNodeID&quot;</span><span class="token operator">:</span> <span class="token string">&quot;XYZ12345&quot;</span><span class="token punctuation">,</span>                                          <span class="token comment">// 0x1D (fixed)</span>
    <span class="token property">&quot;cMetadataURL&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://files.libre.solar/meta/cc-05.json&quot;</span><span class="token punctuation">,</span>    <span class="token comment">// 0x18 (fixed)</span>
    <span class="token property">&quot;Device&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                                                     <span class="token comment">// 0x01</span>
        <span class="token property">&quot;cManufacturer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Libre Solar&quot;</span><span class="token punctuation">,</span>                             <span class="token comment">// 0x30</span>
        <span class="token property">&quot;cType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MPPT 4820 HC v1.1&quot;</span><span class="token punctuation">,</span>                               <span class="token comment">// 0x31</span>
        <span class="token property">&quot;cFirmwareVersion&quot;</span><span class="token operator">:</span> <span class="token string">&quot;v21.0-g923d536&quot;</span><span class="token punctuation">,</span>                       <span class="token comment">// 0x32</span>
        <span class="token property">&quot;rErrorFlags&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>                                           <span class="token comment">// 0x33</span>
        <span class="token property">&quot;xReset&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                                               <span class="token comment">// 0x34</span>
        <span class="token property">&quot;xAuth&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;uPassword&quot;</span><span class="token punctuation">]</span>                                      <span class="token comment">// 0x35</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Bat&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                                                        <span class="token comment">// 0x02</span>
        <span class="token property">&quot;rMeas_V&quot;</span><span class="token operator">:</span> <span class="token number">12.9</span><span class="token punctuation">,</span>                                            <span class="token comment">// 0x40</span>
        <span class="token property">&quot;rMeas_A&quot;</span><span class="token operator">:</span> <span class="token number">-3.14</span><span class="token punctuation">,</span>                                           <span class="token comment">// 0x41</span>
        <span class="token property">&quot;sTarget_V&quot;</span><span class="token operator">:</span> <span class="token number">14.4</span>                                           <span class="token comment">// 0x42</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Solar&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                                                      <span class="token comment">// 0x03</span>
        <span class="token property">&quot;rState&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>                                                <span class="token comment">// 0x50</span>
        <span class="token property">&quot;r_W&quot;</span><span class="token operator">:</span> <span class="token number">96.5</span><span class="token punctuation">,</span>                                                <span class="token comment">// 0x51</span>
        <span class="token property">&quot;pTotal_kWh&quot;</span><span class="token operator">:</span> <span class="token number">1984</span>                                          <span class="token comment">// 0x52</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Load&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                                                       <span class="token comment">// 0x04</span>
        <span class="token property">&quot;wEnable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                                            <span class="token comment">// 0x60</span>
        <span class="token property">&quot;r_W&quot;</span><span class="token operator">:</span> <span class="token number">137.0</span><span class="token punctuation">,</span>                                               <span class="token comment">// 0x61</span>
        <span class="token property">&quot;pTotal_kWh&quot;</span><span class="token operator">:</span> <span class="token number">1789</span>                                          <span class="token comment">// 0x62</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Log&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>                                                        <span class="token comment">// 0x08</span>
        <span class="token punctuation">{</span>                                                           <span class="token comment">// #0</span>
            <span class="token property">&quot;t_s&quot;</span><span class="token operator">:</span> <span class="token number">460677000</span><span class="token punctuation">,</span>                                       <span class="token comment">// 0x70 (shared)</span>
            <span class="token property">&quot;rErrorFlags&quot;</span><span class="token operator">:</span> <span class="token number">4</span>                                        <span class="token comment">// 0x71 (shared)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>                                                         <span class="token comment">// #1</span>
            <span class="token property">&quot;t_s&quot;</span><span class="token operator">:</span> <span class="token number">460671000</span><span class="token punctuation">,</span>                                       <span class="token comment">// 0x70 (shared)</span>
            <span class="token property">&quot;rErrorFlags&quot;</span><span class="token operator">:</span> <span class="token number">256</span>                                      <span class="token comment">// 0x71 (shared)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;eBoot&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;cMetadataURL&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Device/cFirmwareCommit&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token comment">// 0x05</span>
    <span class="token property">&quot;eState&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;t_s&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Device/rErrorFlags&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        <span class="token comment">// 0x06</span>
    <span class="token property">&quot;m&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;t_s&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Bat/rMeas_V&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Solar/r_W&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Load/r_W&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>           <span class="token comment">// 0x07</span>
    <span class="token property">&quot;_pub&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                                                       <span class="token comment">// 0x0F</span>
        <span class="token property">&quot;eState&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                                                 <span class="token comment">// 0xF0</span>
            <span class="token property">&quot;sEnable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                                        <span class="token comment">// 0xF1</span>
            <span class="token property">&quot;cRateLimit_s&quot;</span><span class="token operator">:</span> <span class="token number">1</span>                                       <span class="token comment">// 0xF2</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;m&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                                                      <span class="token comment">// 0xF3</span>
            <span class="token property">&quot;sEnable&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>                                       <span class="token comment">// 0xF4</span>
            <span class="token property">&quot;sPeriod_s&quot;</span><span class="token operator">:</span> <span class="token number">10</span>                                         <span class="token comment">// 0xF5</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_ids&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                                                       <span class="token comment">// 0x16 (fixed)</span>
        <span class="token property">&quot;Device&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Bat&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token comment">// ...</span>
        <span class="token property">&quot;Bat/rMeas_V&quot;</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">,</span>
        <span class="token comment">// ...</span>
        <span class="token property">&quot;Log/t_s&quot;</span><span class="token operator">:</span> <span class="token number">112</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Log/ErrorFlags&quot;</span><span class="token operator">:</span> <span class="token number">113</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                                                     <span class="token comment">// 0x17 (fixed)</span>
        <span class="token property">&quot;0x01&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Device&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;0x02&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bat&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// ...</span>
        <span class="token property">&quot;0x40&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bat/rMeas_V&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// ...</span>
        <span class="token property">&quot;0x70&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Log/t_s&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;0x71&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Log/ErrorFlags&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>_pub</code> path is used to configure the automatic publication of messages, so it doesn&#39;t hold normal data objects. Such internal objects are prefixed with a <code>_</code>, similar to private functions in some programming languages.</p><h3 id="user-interface-processing" tabindex="-1"><a class="header-anchor" href="#user-interface-processing" aria-hidden="true">#</a> User interface processing</h3><p>One major goal of ThingSet is that the data model provides sufficient semantic information to build simple user interfaces to interact with the device and read/update the data.</p><p>For the user interface, item prefixes can be used to display the data in a different way depending on its type, e.g. write-able values can be rendered as a text input or executable items as a button.</p><p>The prefixes themselves and should be omitted in the user interface and single words of object names can be split. Also, units should be parsed such that the actual unit is displayed and not an equivalent like <code>degC</code> for <code>°C</code>.</p><p>Physical quantities can be added based on the unit, e.g. <code>Power</code> for <code>W</code>.</p><p>Below structure gives an example of the processed user interface structure for above data. Instead of pure text, this structure could be easily rendered in a web page or phone app.</p><div class="language-text ext-text"><pre class="language-text"><code>                       ThingSet Node XYZ12345 Data Objecs

        ├─ Device
        │  ├─ Manufacturer                                  Libre Solar
        │  ├─ Type                                    MPPT 4820 HC v1.1
        │  ├─ Firmware Version                           v21.0-g923d536
        │  ├─ Error Flags                                             0
        │  ├─ Reset                                              [ OK ]
        │  └─ Auth                                  | Password | [ OK ]
        │
        ├─ Bat
        │  ├─ Meas Voltage                                       12.9 V
        │  ├─ Meas Current                                      -3.14 A
        │  └─ Target Voltage                                 | 14.4 | V
        │
        ├─ Solar
        │  ├─ State                                                   1
        │  ├─ Power                                              96.4 W
        │  └─ Total Energy                                     1984 kWh
        │
        ├─ Load
        │  ├─ Power                                             137.0 W
        │  ├─ Total Energy                                     1789 kWh
        │  └─ Enable                                                [x]
        │
        └─ Publications / Notificatons
           │
           ├─ Boot Events
           │  └─ Items                               [ Add ] [ Delete ]
           │     ├─ Metadata URL
           │     └─ Device Firmware Version
           │
           ├─ State Events
           │  ├─ Enable                                             [x]
           │  ├─ Rate Limit                                     | 1 | s
           │  └─ Items                               [ Add ] [ Delete ]
           │     ├─ Time (s)
           │     └─ Device Error Flags
           │
           └─ Metrics
              ├─ Enable                                             [ ]
              ├─ Period                                        | 10 | s
              └─ Items                               [ Add ] [ Delete ]
                 ├─ Time (s)
                 ├─ Bat Meas Voltage (V)
                 ├─ Solar Power (W)
                 └─ Load Power (W)
</code></pre></div><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/ThingSet/thingset.github.io/edit/bin-record-support/docs/spec/v0.5/appl_data_structure.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">2/6/2024, 1:58:47 PM</span></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/branch/bin-record-support/spec/v0.5/appl_general_concept.html" class="nav-link" aria-label="General Concept"><!--[--><!--]--> General Concept <!--[--><!--]--></a></span><span class="next"><a href="/branch/bin-record-support/spec/v0.5/appl_access_functions.html" class="nav-link" aria-label="Access Functions"><!--[--><!--]--> Access Functions <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main><!--]--></div><div class="footer"><span style="padding:5px;"><a href="https://github.com/ThingSet"><img src="/images/github-logo.svg" height="14"> GitHub</a></span> | <span style="padding:5px;">Developed by Libre Solar Technologies GmbH</span> | <span style="padding:5px;"><a href="/contact.html">Contact / Impressum</a></span></div><!--]--><!----><!--]--></div>
    <script src="/branch/bin-record-support/assets/js/runtime~app.35fb79fa.js" defer></script><script src="/branch/bin-record-support/assets/js/9296.89757b8c.js" defer></script><script src="/branch/bin-record-support/assets/js/app.5aec81c2.js" defer></script>
  </body>
</html>

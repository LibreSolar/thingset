<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"><link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5"><link rel="shortcut icon" href="/favicons/favicon.ico"><meta name="msapplication-TileColor" content="#2b5797"><meta name="msapplication-config" content="/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><title>Binary Mode | ThingSet</title><meta name="description" content="The Data Accessibility Framework"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.23">
    <link rel="preload" href="/branch/bin-ids-from-paths/assets/js/runtime~app.d0a8d64d.js" as="script"><link rel="preload" href="/branch/bin-ids-from-paths/assets/css/styles.478483c4.css" as="style"><link rel="preload" href="/branch/bin-ids-from-paths/assets/js/9296.89757b8c.js" as="script"><link rel="preload" href="/branch/bin-ids-from-paths/assets/js/app.b6915e6f.js" as="script">
    <link rel="stylesheet" href="/branch/bin-ids-from-paths/assets/css/styles.478483c4.css">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/branch/bin-ids-from-paths/" class=""><img class="logo" src="/branch/bin-ids-from-paths/images/thingset-logo.png" alt="ThingSet"><span class="site-name can-hide">ThingSet</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/v0.5/introduction" class="nav-link" aria-label="v0.5 (current)"><!--[--><!--]--> v0.5 (current) <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/v0.4/introduction" class="nav-link" aria-label="v0.4"><!--[--><!--]--> v0.4 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/v0.3/1a_introduction" class="nav-link" aria-label="v0.3"><!--[--><!--]--> v0.3 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/v0.2/1a_introduction" class="nav-link" aria-label="v0.2"><!--[--><!--]--> v0.2 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/v0.1/" class="nav-link" aria-label="v0.1"><!--[--><!--]--> v0.1 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/changelog" class="nav-link" aria-label="Changelog"><!--[--><!--]--> Changelog <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/v0.5/introduction" class="nav-link" aria-label="v0.5 (current)"><!--[--><!--]--> v0.5 (current) <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/v0.4/introduction" class="nav-link" aria-label="v0.4"><!--[--><!--]--> v0.4 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/v0.3/1a_introduction" class="nav-link" aria-label="v0.3"><!--[--><!--]--> v0.3 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/v0.2/1a_introduction" class="nav-link" aria-label="v0.2"><!--[--><!--]--> v0.2 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/v0.1/" class="nav-link" aria-label="v0.1"><!--[--><!--]--> v0.1 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/bin-ids-from-paths/spec/changelog" class="nav-link" aria-label="Changelog"><!--[--><!--]--> Changelog <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">Why ThingSet?</p><ul class=""><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/1a_introduction.html" class="nav-link sidebar-item" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/1b_existing_solutions.html" class="nav-link sidebar-item" aria-label="Existing Standards"><!--[--><!--]--> Existing Standards <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item active">Application Layer</p><ul class=""><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/2a_general.html" class="nav-link sidebar-item" aria-label="General Concept"><!--[--><!--]--> General Concept <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/2b_text_mode.html" class="nav-link sidebar-item" aria-label="Text Mode"><!--[--><!--]--> Text Mode <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-ids-from-paths/spec/v0.3/2c_binary_mode.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="Binary Mode"><!--[--><!--]--> Binary Mode <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/branch/bin-ids-from-paths/spec/v0.3/2c_binary_mode.html#requests" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Requests"><!--[--><!--]--> Requests <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-ids-from-paths/spec/v0.3/2c_binary_mode.html#response" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Response"><!--[--><!--]--> Response <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-ids-from-paths/spec/v0.3/2c_binary_mode.html#publication-message" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Publication message"><!--[--><!--]--> Publication message <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-ids-from-paths/spec/v0.3/2c_binary_mode.html#name-and-id-mapping" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Name and ID mapping"><!--[--><!--]--> Name and ID mapping <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-ids-from-paths/spec/v0.3/2c_binary_mode.html#read-data" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Read data"><!--[--><!--]--> Read data <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-ids-from-paths/spec/v0.3/2c_binary_mode.html#update-data" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Update data"><!--[--><!--]--> Update data <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-ids-from-paths/spec/v0.3/2c_binary_mode.html#create-data" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Create data"><!--[--><!--]--> Create data <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-ids-from-paths/spec/v0.3/2c_binary_mode.html#delete-data" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Delete data"><!--[--><!--]--> Delete data <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-ids-from-paths/spec/v0.3/2c_binary_mode.html#execute-function" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Execute function"><!--[--><!--]--> Execute function <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/bin-ids-from-paths/spec/v0.3/2c_binary_mode.html#other-functions" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Other functions"><!--[--><!--]--> Other functions <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Lower Layers</p><ul class=""><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/3a_serial.html" class="nav-link sidebar-item" aria-label="Serial"><!--[--><!--]--> Serial <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/3b_can.html" class="nav-link sidebar-item" aria-label="CAN"><!--[--><!--]--> CAN <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/3c_lorawan.html" class="nav-link sidebar-item" aria-label="LoRaWAN"><!--[--><!--]--> LoRaWAN <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Protocol Mapping</p><ul class=""><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/4a_http.html" class="nav-link sidebar-item" aria-label="HTTP"><!--[--><!--]--> HTTP <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/4b_coap.html" class="nav-link sidebar-item" aria-label="CoAP"><!--[--><!--]--> CoAP <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/4c_mqtt.html" class="nav-link sidebar-item" aria-label="MQTT"><!--[--><!--]--> MQTT <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Tools</p><ul class=""><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/5a_serial.html" class="nav-link sidebar-item" aria-label="Serial"><!--[--><!--]--> Serial <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/bin-ids-from-paths/spec/v0.3/5b_can.html" class="nav-link sidebar-item" aria-label="CAN bus"><!--[--><!--]--> CAN bus <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="binary-mode" tabindex="-1"><a class="header-anchor" href="#binary-mode" aria-hidden="true">#</a> Binary Mode</h1><p>In the binary mode, the data is encoded using the CBOR format. The data structure is the same as in text mode, but numeric node IDs are used as identifiers by default instead of the node names.</p><p>The length of the entire request or response is not encoded in the ThingSet protocol, but can be determined from the CBOR format. Packet length as well as checksums should be encoded in lower layer protocols. It is assumed that the parser always receives a complete request.</p><h3 id="requests" tabindex="-1"><a class="header-anchor" href="#requests" aria-hidden="true">#</a> Requests</h3><p>Each request message consists of a first byte as the request method identifier, a path or ID specifying the endpoint of the request and CBOR data as payload (if applicable).</p><pre><code>bin-request = bin-get / bin-post / bin-delete / bin-fetch / bin-ipatch / bin-nameid

bin-get    = %x01 endpoint get-type

bin-post   = %x02 endpoint cbor-data      ; exec or create is determined
                                          ; based on node type

bin-delete = %x04 endpoint cbor-uint      ; only for valid node IDs

bin-fetch  = %x05 endpoint cbor-array     ; returns only values, no keys

bin-ipatch = %x07 endpoint cbor-map

bin-nameid = %x1E endpoint cbor-array     ; get names of ids or vice versa

endpoint   = path         ; CBOR string: path same as text mode
           / parent-id    ; CBOR uint: parent node ID instead of path
           / %xF7         ; CBOR undefined: wildcard matching any path / parent

get-type   = %xF7         ; CBOR undefined: returns array of node IDs (default)
           / %x80         ; CBOR emtpy array: returns array of names
           / %xA0         ; CBOR empty map: returns name:value map
</code></pre><h3 id="response" tabindex="-1"><a class="header-anchor" href="#response" aria-hidden="true">#</a> Response</h3><p>Responses in binary mode start with the error/status code as specified before, followed by the data if applicable.</p><pre><code>bin-response = %x80-FF [ cbor-data ]      ; response code and data
</code></pre><h3 id="publication-message" tabindex="-1"><a class="header-anchor" href="#publication-message" aria-hidden="true">#</a> Publication message</h3><p>Binary publication messages follow the same concept as in text mode.</p><pre><code>bin-pubmsg = %x1F cbor-map                ; map containing node IDs and values
</code></pre><h2 id="name-and-id-mapping" tabindex="-1"><a class="header-anchor" href="#name-and-id-mapping" aria-hidden="true">#</a> Name and ID mapping</h2><p>The examples in this chapter are based on the same data structure as introduced in the <a href="/branch/bin-ids-from-paths/spec/v0.3/2a_general.html#data-structure" class="">General Concept chapter</a>, but each node is identified by an ID. The assignment of IDs and names is shown in the following JSON-like structure (actual JSON supports neither numbers as keys nor comments):</p><div class="language-JSON ext-JSON"><pre class="language-JSON"><code>{
    &quot;18&quot;: {                             // info
        &quot;19&quot;: &quot;MPPT 1210 HUS&quot;,          // DeviceType
    },
    &quot;30&quot;: {                             // conf
        &quot;31&quot;: 14.4,                     // BatCharging_V
    },
    &quot;60&quot;: {                             // input
        &quot;61&quot;: true                      // EnableCharging
    },
    &quot;70&quot;: {                             // output
        &quot;71&quot;: 14.1,                     // Bat_V
        &quot;72&quot;: 5.13,                     // Bat_A
        &quot;73&quot;: 22                        // Ambient_degC
    },
    &quot;A0&quot;: {                             // rec
        &quot;A1&quot;: 1984,                     // BatChgDay_Wh
    },
    &quot;D0&quot;: {                             // cal
    },
    &quot;E0&quot;: {                             // exec
        &quot;E1&quot;: null,                     // reset
    },
    &quot;EF&quot;: [&quot;Password&quot;],                 // auth
    &quot;F0&quot;: {                             // pub
        &quot;F1&quot;: {                         // serial
            &quot;F2&quot;: true,                 // Enable
            &quot;F3&quot;: 1.0,                  // Interval
            &quot;F4&quot;: [&quot;71&quot;, &quot;72&quot;]          // IDs
        },
        &quot;F5&quot;: {                         // can
            &quot;F6&quot;: false,                // Enable
            &quot;F7&quot;: 0.1,                  // Interval
            &quot;F8&quot;: [&quot;71&quot;]                // IDs
        }
    }
}
</code></pre></div><p>The firmware developer is free to choose the IDs. However, above IDs for the nodes of the first layer are used by Libre Solar devices and recommended for the following reasons:</p><ul><li>IDs from 0x00 to 0x17 are left for data nodes that are sent very often, as they consume only a single byte in CBOR encoding</li><li>The node IDs specifying the categories are spaced such that there should be enough free node IDs for most devices</li><li>As the node IDs are strictly increasing, the data layot is compatible with the draft standard <a href="https://tools.ietf.org/html/draft-ietf-core-yang-cbor" target="_blank" rel="noopener noreferrer">CBOR Encoding of Data Modeled with YANG<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>.</li></ul><p>In contrast to the text mode, the binary mode has a special NAMEID request (without CoAP equivalent) that allows to get a name for an ID or vice versa.</p><p><strong>Example 1:</strong> Request name of node IDs 0x71 and 0x72</p><pre><code>Request:
1E                                      NAMEID request
   18 70                                # CBOR uint: 0x70 (parent ID)
   82                                   # CBOR array (2 elements)
      18 71                             # CBOR uint: 0x71 (node ID)
      18 72                             # CBOR uint: 0x72 (node ID)

Response:
85                                      Content.
   82                                   # CBOR array (2 elements)
      65 4261745F56                     # CBOR string: &quot;Bat_V&quot;
      65 4261745F41                     # CBOR string: &quot;Bat_A&quot;
</code></pre><p>If the parent ID is passed as the endpoint, only the data node name is returned. All requested nodes must be children of the same parend node in this case.</p><p><strong>Example 2:</strong> Request full path of node ID 0x71 (Bat_V)</p><pre><code>Request:
1E                                      NAMEID request
   F7                                   # CBOR undefined as a wildcard
   18 71                                # CBOR uint: 0x71 (node ID)

Response:
85                                      Content.
   6C 6F75747075742F4261745F56          # CBOR string: &quot;output/Bat_V&quot;
</code></pre><p>If the path of a node is unknown (e.g. because it was obtained from a publication message), the entire path (see text mode) can be determined by setting the endpoint to undefined, as shown above.</p><p><strong>Example 3:</strong> Request IDs for known data node names</p><pre><code>Request:
1E                                      NAMEID request
   F7                                   # CBOR undefined as a wildcard
   82                                   # CBOR array (2 elements)
      65 4261745F56                     # CBOR string: &quot;Bat_V&quot;
      65 4261745F41                     # CBOR string: &quot;Bat_A&quot;

Response:
85                                      Content.
   82                                   # CBOR array (2 elements)
      18 71                             # CBOR uint: 0x71 (node ID)
      18 72                             # CBOR uint: 0x72 (node ID)
</code></pre><p>Also here a wildcard for the endpoint can be used to query the entire database. However, if multiple nodes with the same name are found, an error must be returned. This should not be the case for a properly designed data structure.</p><h2 id="read-data" tabindex="-1"><a class="header-anchor" href="#read-data" aria-hidden="true">#</a> Read data</h2><p>Similar to the text mode, the binary variants of the GET and FETCH functions also allow to read one or more data objects. The objects are identified by their parent node (endpoint of a path) and their ID or their name.</p><p>The GET function is useful for device discovery, as it can list all childs of a node. Depending on the computing power of the device and the host, the GET request can either return only the IDs of the next layer or maps including the values. In order to be compatible to the text mode, it is also possible to retrieve all child nodes of a resource as a map of name/value pairs.</p><p>The binary mode also allows to work only with IDs and no paths or node names to keep message size at a minimum. In order to discover the nodes of a device, the host can first query all child IDs of a node (starting with root node of ID 0), afterwards query the names for each ID once and then request the value for any data object on demand.</p><p><strong>Example 1:</strong> Discover all child nodes of the root node (i.e. categories)</p><pre><code>Request:
01                                      GET request
   00                                   # CBOR uint: 0x00 (root node)
   F7                                   # CBOR undefined as a wildcard

Response:
85                                      Content.
   89                                   # CBOR array (9 elements)
      18 18                             # CBOR uint: 0x18
      18 30                             # CBOR uint: 0x30
       ...
      18 F0                             # CBOR data: 0xF0
</code></pre><p><strong>Example 2:</strong> Retrieve all data of output path (keys + values)</p><pre><code>Request (alternative 1):
01                                      GET request
   18 70                                # CBOR uint: 0x70
   A0                                   # CBOR empty map

Request (alternative 2):
01                                      GET request
   66 6F7574707574                      # CBOR string: &quot;output&quot;
   A0                                   # CBOR empty map

Response:
85                                      Content.
   A3                                   # CBOR map (3 elements)
      65 4261745F56                     # CBOR string: &quot;Bat_V&quot;
      FA 4161999A                       # CBOR float: 14.1
      65 4261745F41                     # CBOR string: &quot;Bat_A&quot;
      FA 40A428F6                       # CBOR float: 5.13
      6C 416D6269656E745F64656743       # CBOR string: &quot;Ambient_degC&quot;
      16                                # CBOR uint: 22
</code></pre><p>Note that the empty map requests to respond with name/value pairs as specified in the request grammar at the beginning of the chapter.</p><p><strong>Example 3:</strong> Retrieve value of data node &quot;Bat_V&quot;</p><pre><code>Request (alternative 1):
05                                      FETCH request
   66 6F7574707574                      # CBOR string: &quot;output&quot; (path)
   65 4261745F56                        # CBOR string: &quot;Bat_V&quot; (node name)

Request (alternative 2):
05                                      FETCH request
   18 70                                # CBOR uint: 0x70 (parent ID)
   18 71                                # CBOR uint: 0x71 (node ID)

Response:
85                                      Content.
   FA 4161999A                          # CBOR float: 14.1
</code></pre><p><strong>Example 4:</strong> Retrieve multiple data nodes:</p><pre><code>Request:
05                                      FETCH request
   18 70                                # CBOR uint: 0x70 (parent ID)
   82                                   # CBOR array (2 elements)
      18 71                             # CBOR uint: 0x71 (node ID)
      18 72                             # CBOR uint: 0x72 (node ID)

Response:
85                                      Content.
   82                                   # CBOR array (2 elements)
      FA 4161999A                       # CBOR float: 14.1
      16                                # CBOR uint: 22
</code></pre><p>The binary mode also allows to use data object names (strings) instead of numeric IDs, which increases the amount of transferred data.</p><h2 id="update-data" tabindex="-1"><a class="header-anchor" href="#update-data" aria-hidden="true">#</a> Update data</h2><p>Requests to overwrite the value a data node.</p><p>The device must support a patch request using the same CBOR data type as used in the response of a GET or FETCH request for the given objects. Optionally, the device may also accept different data types (e.g. float32 instead of int) and convert the data internally.</p><p>If the data type is not supported, an error status code (36) is responded.</p><p><strong>Example 1:</strong> Disable charging</p><pre><code>Request:
07                                      PATCH request
   18 70                                # CBOR uint: 0x70
   A1                                   # CBOR map (1 element)
      18 61                             # CBOR uint: 0x61
      F4                                # CBOR data: false

Response:
84                                      Changed.
</code></pre><p><strong>Example 2:</strong> Attempt to write read-only measurement values (output category)</p><pre><code>Request:
07                                      PATCH request
   A2                                   # CBOR map (2 elements)
      18 71                             # CBOR uint: 0x71
      FA 0x41633333                     # CBOR float32: 14.2
      18 73                             # CBOR uint: 0x73
      16                                # CBOR uint: 22

Response:
A3                                      Forbidden.
</code></pre><h2 id="create-data" tabindex="-1"><a class="header-anchor" href="#create-data" aria-hidden="true">#</a> Create data</h2><p>Appends new data to a data node in a similar way as in the text mode.</p><p><strong>Example 1:</strong> Add node ID 0x72 (Bat_A) to the serial publication channel</p><pre><code>Request:
02                                      POST request
   18 F4                                # CBOR uint: 0xF4 (parent ID)
   18 72                                # CBOR uint: 0x72 (node ID)

Response:
81                                      Created.
</code></pre><h2 id="delete-data" tabindex="-1"><a class="header-anchor" href="#delete-data" aria-hidden="true">#</a> Delete data</h2><p>Removes data from a node of array type.</p><p><strong>Example 1:</strong> Remove node ID 0x72 (Bat_A) from serial publication channel</p><pre><code>Request:
04                                      DELETE request
   18 F4                                # CBOR uint: 0xF4 (parent ID)
   18 72                                # CBOR uint: 0x72 (node ID)

Response:
82                                      Deleted.
</code></pre><h2 id="execute-function" tabindex="-1"><a class="header-anchor" href="#execute-function" aria-hidden="true">#</a> Execute function</h2><p>For execution of a function, the same POST request is used as when creating data. The device decides based on the type of the endpoint whether the request is a function call or a request to create data.</p><p><strong>Example 1:</strong> Reset the device</p><pre><code>Request:
02                                      POST request
   18 E1                                # CBOR uint: 0xE1 (node ID)
   80                                   # CBOR empty array

Response:
83                                      Valid.
</code></pre><p>Note that the endpoint is the node of the executable function itself. Data can be passed to the called function as the second parameter, but the &quot;reset&quot; function does not require any parameters, so it receives an empty array.</p><h2 id="other-functions" tabindex="-1"><a class="header-anchor" href="#other-functions" aria-hidden="true">#</a> Other functions</h2><p>Authentication, publication request setup and publication messages work analog to text mode.</p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/ThingSet/thingset.github.io/edit/bin-ids-from-paths/docs/spec/v0.3/2c_binary_mode.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">5/31/2022, 3:47:34 PM</span></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/branch/bin-ids-from-paths/spec/v0.3/2b_text_mode.html" class="nav-link" aria-label="Text Mode"><!--[--><!--]--> Text Mode <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><div class="footer"><span style="padding:5px;"><a href="https://github.com/ThingSet"><img src="/images/github-logo.svg" height="14"> GitHub</a></span> | <span style="padding:5px;">Developed by Libre Solar Technologies GmbH</span> | <span style="padding:5px;"><a href="/contact.html">Contact / Impressum</a></span></div><!--]--><!----><!--]--></div>
    <script src="/branch/bin-ids-from-paths/assets/js/runtime~app.d0a8d64d.js" defer></script><script src="/branch/bin-ids-from-paths/assets/js/9296.89757b8c.js" defer></script><script src="/branch/bin-ids-from-paths/assets/js/app.b6915e6f.js" defer></script>
  </body>
</html>

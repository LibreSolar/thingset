<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"><link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5"><link rel="shortcut icon" href="/favicons/favicon.ico"><meta name="msapplication-TileColor" content="#2b5797"><meta name="msapplication-config" content="/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><title>MQTT | ThingSet</title><meta name="description" content="The Data Accessibility Framework"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.23">
    <link rel="preload" href="/branch/can-bus-number-rework/assets/js/runtime~app.27250a9c.js" as="script"><link rel="preload" href="/branch/can-bus-number-rework/assets/css/styles.7673cecb.css" as="style"><link rel="preload" href="/branch/can-bus-number-rework/assets/js/9296.89757b8c.js" as="script"><link rel="preload" href="/branch/can-bus-number-rework/assets/js/app.1226530f.js" as="script">
    <link rel="stylesheet" href="/branch/can-bus-number-rework/assets/css/styles.7673cecb.css">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/branch/can-bus-number-rework/" class=""><img class="logo" src="/branch/can-bus-number-rework/images/thingset-logo.png" alt="ThingSet"><span class="site-name can-hide">ThingSet</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Software"><span class="title">Software</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Software"><span class="title">Software</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/branch/can-bus-number-rework/software/node_library" class="nav-link" aria-label="Node Library"><!--[--><!--]--> Node Library <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/software/zephyr_sdk" class="nav-link" aria-label="SDK for Zephyr"><!--[--><!--]--> SDK for Zephyr <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/software/app" class="nav-link" aria-label="Mobile App"><!--[--><!--]--> Mobile App <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.6/introduction/abstract" class="nav-link" aria-label="v0.6"><!--[--><!--]--> v0.6 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.5/introduction" class="nav-link" aria-label="v0.5"><!--[--><!--]--> v0.5 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.4/introduction" class="nav-link" aria-label="v0.4"><!--[--><!--]--> v0.4 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.3/1a_introduction" class="nav-link" aria-label="v0.3"><!--[--><!--]--> v0.3 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.2/1a_introduction" class="nav-link" aria-label="v0.2"><!--[--><!--]--> v0.2 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.1/" class="nav-link" aria-label="v0.1"><!--[--><!--]--> v0.1 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/changelog" class="nav-link" aria-label="Changelog"><!--[--><!--]--> Changelog <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Software"><span class="title">Software</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Software"><span class="title">Software</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/branch/can-bus-number-rework/software/node_library" class="nav-link" aria-label="Node Library"><!--[--><!--]--> Node Library <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/software/zephyr_sdk" class="nav-link" aria-label="SDK for Zephyr"><!--[--><!--]--> SDK for Zephyr <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/software/app" class="nav-link" aria-label="Mobile App"><!--[--><!--]--> Mobile App <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Specification Menu"><span class="title">Specification</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.6/introduction/abstract" class="nav-link" aria-label="v0.6"><!--[--><!--]--> v0.6 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.5/introduction" class="nav-link" aria-label="v0.5"><!--[--><!--]--> v0.5 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.4/introduction" class="nav-link" aria-label="v0.4"><!--[--><!--]--> v0.4 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.3/1a_introduction" class="nav-link" aria-label="v0.3"><!--[--><!--]--> v0.3 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.2/1a_introduction" class="nav-link" aria-label="v0.2"><!--[--><!--]--> v0.2 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/v0.1/" class="nav-link" aria-label="v0.1"><!--[--><!--]--> v0.1 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/branch/can-bus-number-rework/spec/changelog" class="nav-link" aria-label="Changelog"><!--[--><!--]--> Changelog <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">Introduction</p><ul class=""><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/introduction/abstract.html" class="nav-link sidebar-item" aria-label="Abstract"><!--[--><!--]--> Abstract <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/introduction/objectives.html" class="nav-link sidebar-item" aria-label="Objectives"><!--[--><!--]--> Objectives <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/introduction/terminology.html" class="nav-link sidebar-item" aria-label="Terminology"><!--[--><!--]--> Terminology <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Data Model</p><ul class=""><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/data_model/structure.html" class="nav-link sidebar-item" aria-label="Structure"><!--[--><!--]--> Structure <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/data_model/overlays.html" class="nav-link sidebar-item" aria-label="Overlays"><!--[--><!--]--> Overlays <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Protocol</p><ul class=""><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/protocol/connectivity.html" class="nav-link sidebar-item" aria-label="Connectivity"><!--[--><!--]--> Connectivity <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/protocol/functions.html" class="nav-link sidebar-item" aria-label="Access Functions"><!--[--><!--]--> Access Functions <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/protocol/text_mode.html" class="nav-link sidebar-item" aria-label="Text Mode"><!--[--><!--]--> Text Mode <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/protocol/binary_mode.html" class="nav-link sidebar-item" aria-label="Binary Mode"><!--[--><!--]--> Binary Mode <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Transports</p><ul class=""><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/transports/serial.html" class="nav-link sidebar-item" aria-label="Serial"><!--[--><!--]--> Serial <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/transports/websocket.html" class="nav-link sidebar-item" aria-label="WebSocket"><!--[--><!--]--> WebSocket <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/transports/can.html" class="nav-link sidebar-item" aria-label="CAN"><!--[--><!--]--> CAN <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/transports/bluetooth.html" class="nav-link sidebar-item" aria-label="BLE"><!--[--><!--]--> BLE <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item active">Mappings</p><ul class=""><li><!--[--><a aria-current="page" href="/branch/can-bus-number-rework/spec/v0.6/mappings/mqtt.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="MQTT"><!--[--><!--]--> MQTT <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/branch/can-bus-number-rework/spec/v0.6/mappings/mqtt.html#general-thoughts" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="General thoughts"><!--[--><!--]--> General thoughts <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/can-bus-number-rework/spec/v0.6/mappings/mqtt.html#reports-and-desires" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Reports and desires"><!--[--><!--]--> Reports and desires <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/can-bus-number-rework/spec/v0.6/mappings/mqtt.html#request-response" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Request / response"><!--[--><!--]--> Request / response <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/can-bus-number-rework/spec/v0.6/mappings/mqtt.html#connectivity-status" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Connectivity status"><!--[--><!--]--> Connectivity status <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/branch/can-bus-number-rework/spec/v0.6/mappings/mqtt.html#incompatibilities" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Incompatibilities"><!--[--><!--]--> Incompatibilities <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/mappings/coap.html" class="nav-link sidebar-item" aria-label="CoAP"><!--[--><!--]--> CoAP <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/mappings/lorawan.html" class="nav-link sidebar-item" aria-label="LoRaWAN"><!--[--><!--]--> LoRaWAN <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Annex</p><ul class=""><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/annex/a_existing_solutions.html" class="nav-link sidebar-item" aria-label="Annex A: Existing Solutions"><!--[--><!--]--> Annex A: Existing Solutions <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/branch/can-bus-number-rework/spec/v0.6/annex/b_tools.html" class="nav-link sidebar-item" aria-label="Annex B: Tools"><!--[--><!--]--> Annex B: Tools <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="thingset-to-mqtt-mapping" tabindex="-1"><a class="header-anchor" href="#thingset-to-mqtt-mapping" aria-hidden="true">#</a> ThingSet to MQTT mapping</h1><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>The MQTT mapping is still work-in-progress and may change in the future.</p></div><p>This chapter specifies a topic layout that supports the publish/subscribe as well as the request/response feature of ThingSet.</p><p>Typically, a gateway would be used to translate the messages between the node (connected via CAN or serial) and the MQTT broker.</p><h2 id="general-thoughts" tabindex="-1"><a class="header-anchor" href="#general-thoughts" aria-hidden="true">#</a> General thoughts</h2><p>The basic MQTT topic layout for ThingSet follows the below structure:</p><pre><code>{message-type}/{node-id}/{details}
</code></pre><p>The first part of the topic indicates the message type (request, response, desire or report) and mode (text or binary). As MQTT does not allow to specify a content format, the format has to be encoded in the topic.</p><p>The second part contains the node ID, followed by further details depending on the message type.</p><p>This layout allows to easily grant access rights for individual nodes e.g. with following wild card:</p><pre><code>+/{node-id}/#
</code></pre><p>A Gateway that translates MQTT messages for multiple devices (e.g. connected via CAN) has to subscribe to the downlink message topics for each individual connected node.</p><div class="custom-container tip"><p class="custom-container-title">Background information</p><p>Many MQTT services for IoT don&#39;t behave like actual MQTT brokers, but use MQTT only as an API (AWS IoT, Azure IoT, <a href="https://www.eclipse.org/hono/docs/user-guide/mqtt-adapter/" target="_blank" rel="noopener noreferrer">Eclipse Hono<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>, ThingsBoard). This allows to omit the device ID in the MQTT topic and determine the device based on the MQTT Client ID.</p><p>ThingSet supports standard MQTT brokers and thus stores the device ID in the topic. The device ID is also necessary for Gateways.</p><p>A user name is not part of the topic, as device claiming is usually part of the cloud backend and user information may not be stored in the device.</p></div><h2 id="reports-and-desires" tabindex="-1"><a class="header-anchor" href="#reports-and-desires" aria-hidden="true">#</a> Reports and desires</h2><h3 id="reports" tabindex="-1"><a class="header-anchor" href="#reports" aria-hidden="true">#</a> Reports</h3><p>Messages in text mode are published to the <code>rpt</code> path and the payload format must be the valid JSON data extracted from a ThingSet report.</p><p><strong>JSON name:value map, QoS 0/1</strong></p><pre><code>rpt/{node-id}/{group}
</code></pre><p>Messages can also be published directly in the binary format to the <code>r</code> path if the device does not support the text mode.</p><p>Binary messages can either be published as a map or with IDs and values in a separate topic.</p><p><strong>CBOR id:value map, QoS 0/1</strong></p><pre><code>r/{node-id}/m/{group-id}
</code></pre><p><strong>CBOR ids, retained flag, QoS 1</strong></p><pre><code>r/{node-id}/i/{group-id}
</code></pre><p><strong>CBOR values, QoS 0</strong></p><pre><code>r/{node-id}/v/{group-id}
</code></pre><p>The text mode is the preferred way for MQTT communication if supported by the device or gateway.</p><p>A cloud service might subscribe to the CBOR topics and convert them into the JSON topic automatically so that they can be further processed by other services.</p><p>The link to extended device data information will be published to the topic:</p><pre><code>rpt/{node-id}/cMetadataURL
</code></pre><p>If the binary mode is used with separated IDs and values, the IDs should be published with QoS 1 and the retained flag in order to make sure they are always available and matching the values that are sent to the <code>/v/</code> topic.</p><p>Only static information as parts of attribute subsets may use the retained flag. Other data should not set the retained flag, as the data gets outdated quickly.</p><h3 id="desires" tabindex="-1"><a class="header-anchor" href="#desires" aria-hidden="true">#</a> Desires</h3><p>Desires are published by the application with QoS 1 and the retained flag set.</p><p>The nodes must connect to the broker with a clean session (note: retained messages are also kept when connecting with clean session). This avoids that outdated desires are received. Same as for CoAP, the desires must contain all requested updates to the data in the device and not only an incremental update to the data.</p><p><strong>JSON name:value map</strong></p><pre><code>des/{node-id}/{group-name}
</code></pre><p><strong>CBOR id:value map</strong></p><pre><code>d/{node-id}/m/{group-id}
</code></pre><p><strong>CBOR ids</strong></p><pre><code>d/{node-id}/i/{group-id}
</code></pre><p><strong>CBOR values</strong></p><pre><code>d/{node-id}/v/{group-id}
</code></pre><h2 id="request-response" tabindex="-1"><a class="header-anchor" href="#request-response" aria-hidden="true">#</a> Request / response</h2><p>For the request / response messaging mode the response has to be matched with the request. For this reason, the request is stored in a topic with an appended request ID chosen by the requesting device. The response will be stored in a topic containing the same ID.</p><p><strong>Requests (JSON or CBOR)</strong></p><pre><code>req/{node-id}/{cmd-id}
</code></pre><p><strong>Response (JSON or CBOR, same as request)</strong></p><pre><code>rsp/{node-id}/{cmd-id}
</code></pre><p>The above topics contain the entire ThingSet request or response. Hence, both binary or text mode can be used with the same topic.</p><h2 id="connectivity-status" tabindex="-1"><a class="header-anchor" href="#connectivity-status" aria-hidden="true">#</a> Connectivity status</h2><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>This is a first idea for an approach to store connectivity information. Expect changes in the future.</p><p>See also <a href="http://www.steves-internet-guide.com/checking-active-mqtt-client-connections/" target="_blank" rel="noopener noreferrer">here<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> for further ideas.</p></div><p>The following topic is used to store device connectivity status:</p><pre><code>rpt/{node-id}/$conn
</code></pre><ol><li>Client connects and sends 1 to above topic.</li><li>Client sends last will and testament (LWT) with content 0 for that topic.</li><li>On normal disconnect, client sends 0 before disconnecting.</li></ol><p>All messages should be retained.</p><p><strong>Idea:</strong> Use this topic to tell that client is intermittent / async by design (e.g. in case of LoRaWAN).</p><h2 id="incompatibilities" tabindex="-1"><a class="header-anchor" href="#incompatibilities" aria-hidden="true">#</a> Incompatibilities</h2><p>AWS is <a href="https://www.hivemq.com/blog/hivemq-cloud-vs-aws-iot/" target="_blank" rel="noopener noreferrer">not MQTT compliant<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>. Handling of retained messages is wrong. According to MQTT standard, subscribing to a retained topic via wild-cards would deliver the mesage. <a href="https://docs.aws.amazon.com/iot/latest/developerguide/mqtt.html#mqtt-retain" target="_blank" rel="noopener noreferrer">In AWS this is not supported<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>.</p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/ThingSet/thingset.github.io/edit/can-bus-number-rework/docs/spec/v0.6/mappings/mqtt.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">12/5/2023, 9:04:03 AM</span></div><!----></footer><nav class="page-nav"><p class="inner"><!----><span class="next"><a href="/branch/can-bus-number-rework/spec/v0.6/mappings/coap.html" class="nav-link" aria-label="CoAP"><!--[--><!--]--> CoAP <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main><!--]--></div><div class="footer"><span style="padding:5px;"><a href="https://github.com/ThingSet"><img src="/images/github-logo.svg" height="14"> GitHub</a></span> | <span style="padding:5px;">Developed by Libre Solar Technologies GmbH</span> | <span style="padding:5px;"><a href="/contact.html">Contact / Impressum</a></span></div><!--]--><!----><!--]--></div>
    <script src="/branch/can-bus-number-rework/assets/js/runtime~app.27250a9c.js" defer></script><script src="/branch/can-bus-number-rework/assets/js/9296.89757b8c.js" defer></script><script src="/branch/can-bus-number-rework/assets/js/app.1226530f.js" defer></script>
  </body>
</html>

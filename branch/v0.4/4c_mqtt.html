<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MQTT | ThingSet Protocol Specification</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/thingset/branch/v0.4/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/thingset/branch/v0.4/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/thingset/branch/v0.4/favicons/favicon-16x16.png">
    <link rel="manifest" href="/thingset/branch/v0.4/favicons/site.webmanifest">
    <link rel="mask-icon" href="/thingset/branch/v0.4/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/thingset/branch/v0.4/favicons/favicon.ico">
    <meta name="description" content="The ThingSet protocol provides a consistent, standardized way to configure, monitor and control ressource-constrained devices via different communication interfaces like Serial, LoRa, USB, Bluetooth or CAN.">
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/thingset/branch/v0.4/assets/css/0.styles.c027ba64.css" as="style"><link rel="preload" href="/thingset/branch/v0.4/assets/js/app.7e1b989c.js" as="script"><link rel="preload" href="/thingset/branch/v0.4/assets/js/2.d1779d51.js" as="script"><link rel="preload" href="/thingset/branch/v0.4/assets/js/3.b5a90050.js" as="script"><link rel="preload" href="/thingset/branch/v0.4/assets/js/23.8a8cf15c.js" as="script"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/10.68018d76.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/11.c1808bb4.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/12.98ecfbf7.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/13.a3811688.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/14.393e3bc7.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/15.26149b18.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/16.f22c36ee.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/17.76ae0be1.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/18.6145aa14.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/19.4b199fc0.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/20.fc68cf28.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/21.aed46329.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/22.6464eb63.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/24.4d4e7e7e.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/25.36679e33.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/26.151e28b0.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/27.7d1c34c1.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/28.332ba0d7.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/29.b035c8c6.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/30.01b825cc.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/31.30a3565f.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/32.2d4c55b6.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/33.85c3435c.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/34.6ee775b0.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/35.365389ef.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/36.73841804.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/37.24bbb752.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/38.4d7f649a.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/39.f122f195.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/4.b50bddb9.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/40.8469c376.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/41.ae658311.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/42.265302ce.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/43.cd87fd09.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/44.758d214c.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/5.dfd9db3d.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/6.c96e07da.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/7.a2e8fd4a.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/8.baf0f7d8.js"><link rel="prefetch" href="/thingset/branch/v0.4/assets/js/9.1ab050b2.js">
    <link rel="stylesheet" href="/thingset/branch/v0.4/assets/css/0.styles.c027ba64.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/thingset/branch/v0.4/" class="home-link router-link-active"><img src="/thingset/branch/v0.4/favicons/apple-touch-icon.png" alt="ThingSet Protocol Specification" class="logo"> <span class="site-name">ThingSet Protocol Specification</span></a> <div class="links"><div class="search-box can-hide"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="History Menu" class="dropdown-title"><span class="title">History</span> <span class="arrow down"></span></button> <button type="button" aria-label="History Menu" class="mobile-dropdown-title"><span class="title">History</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.4/" class="nav-link">
  v0.4
</a></li><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.4/v0.3/" class="nav-link">
  v0.3
</a></li><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.4/v0.2/" class="nav-link">
  v0.2
</a></li><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.4/v0.1/" class="nav-link">
  v0.1
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="History Menu" class="dropdown-title"><span class="title">History</span> <span class="arrow down"></span></button> <button type="button" aria-label="History Menu" class="mobile-dropdown-title"><span class="title">History</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.4/" class="nav-link">
  v0.4
</a></li><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.4/v0.3/" class="nav-link">
  v0.3
</a></li><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.4/v0.2/" class="nav-link">
  v0.2
</a></li><li class="dropdown-item"><!----> <a href="/thingset/branch/v0.4/v0.1/" class="nav-link">
  v0.1
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Why ThingSet?</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/branch/v0.4/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/thingset/branch/v0.4/1b_existing_solutions.html" class="sidebar-link">Existing Standards</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Application Layer</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/branch/v0.4/2a_general.html" class="sidebar-link">General Concept</a></li><li><a href="/thingset/branch/v0.4/2b_text_mode.html" class="sidebar-link">Text Mode</a></li><li><a href="/thingset/branch/v0.4/2c_binary_mode.html" class="sidebar-link">Binary Mode</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Lower Layers</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/branch/v0.4/3a_serial.html" class="sidebar-link">Serial</a></li><li><a href="/thingset/branch/v0.4/3b_can.html" class="sidebar-link">CAN</a></li><li><a href="/thingset/branch/v0.4/3c_lorawan.html" class="sidebar-link">LoRaWAN</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Protocol Mapping</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/branch/v0.4/4a_http.html" class="sidebar-link">HTTP</a></li><li><a href="/thingset/branch/v0.4/4b_coap.html" class="sidebar-link">CoAP</a></li><li><a href="/thingset/branch/v0.4/4c_mqtt.html" aria-current="page" class="active sidebar-link">MQTT</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/thingset/branch/v0.4/4c_mqtt.html#general-thoughts" class="sidebar-link">General thoughts</a></li><li class="sidebar-sub-header"><a href="/thingset/branch/v0.4/4c_mqtt.html#statements" class="sidebar-link">Statements</a></li><li class="sidebar-sub-header"><a href="/thingset/branch/v0.4/4c_mqtt.html#request-response" class="sidebar-link">Request / response</a></li><li class="sidebar-sub-header"><a href="/thingset/branch/v0.4/4c_mqtt.html#data-processing" class="sidebar-link">Data Processing</a></li><li class="sidebar-sub-header"><a href="/thingset/branch/v0.4/4c_mqtt.html#references" class="sidebar-link">References</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Tools</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/branch/v0.4/5a_serial.html" class="sidebar-link">Serial</a></li><li><a href="/thingset/branch/v0.4/5b_can.html" class="sidebar-link">CAN bus</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="thingset-to-mqtt-mapping"><a href="#thingset-to-mqtt-mapping" class="header-anchor">#</a> ThingSet to MQTT mapping</h1> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>The MQTT mapping is still work-in-progress and may change in the future.</p></div> <p>This chapter specifies a topic layout that supports the publish/subscribe as well as the request/response feature of ThingSet.</p> <p>A gateway has to be used to translate the messages between the device (connected via CAN or serial) and the MQTT broker.</p> <h2 id="general-thoughts"><a href="#general-thoughts" class="header-anchor">#</a> General thoughts</h2> <p>The first part of the MQTT topic contains a user or tenant name and the device ID, followed by <code>rx</code> or <code>tx</code> to indicate the direction of the message. <code>tx</code> means that a message is transmitted from the device to the cloud (uplink), <code>rx</code> means that the device receives a message from the cloud (downlink).</p> <p>Gateway subscribes to (downlink)</p> <div class="language- extra-class"><pre><code>{user}/+/rx/#
</code></pre></div><p>and publishes to (uplink)</p> <div class="language- extra-class"><pre><code>{user}/{device-id}/tx/{path}
</code></pre></div><p><strong>Remark:</strong> For MQTT v3.1.1 it is not possible to use the same node for uplink and downlink messages, as a device would receive its own published message if it subscribed to the topic aswell. Only MQTT v5 has a &quot;No Local&quot; bit to prevent getting messages from same clientID.</p> <p>This topic layout allows to easily grant access rights on user or device basis, e.g. with following wild card:</p> <div class="language- extra-class"><pre><code>{user}/{device-id}/#
</code></pre></div><p>Topics are sent with every single MQTT message. In order to keep them as short as possible, no additional versioning prefix is added.</p> <h2 id="statements"><a href="#statements" class="header-anchor">#</a> Statements</h2> <h3 id="device-to-cloud"><a href="#device-to-cloud" class="header-anchor">#</a> Device to cloud</h3> <p>Messages in text mode are published to the <code>tx</code> path and the payload format must be the valid JSON data extracted from a ThingSet statement.</p> <p><strong>JSON name:value map, QoS 0/1</strong></p> <div class="language- extra-class"><pre><code>{user}/{device-id}/tx/{group}
</code></pre></div><p>Messages can also be published directly in the binary format to the <code>txb</code> topic if the device does not support the text mode.</p> <p>Binary messages can either be published as a map or with IDs and values in a separate topic.</p> <p><strong>CBOR id:value map, QoS 0/1</strong></p> <div class="language- extra-class"><pre><code>{user}/{device-id}/txb/m/{group-id}
</code></pre></div><p><strong>CBOR ids, retained flag, QoS 1</strong></p> <div class="language- extra-class"><pre><code>{user}/{device-id}/txb/i/{group-id}
</code></pre></div><p><strong>CBOR values, QoS 0</strong></p> <div class="language- extra-class"><pre><code>{user}/{device-id}/txb/v/{group-id}
</code></pre></div><p>The main topic is ../tx/{group-name}, which should be used by a device / gateway if supported. This topic is also subscribed to for writing into a database.</p> <p>A cloud service might subscribe to the CBOR topics and convert them into the JSON topic automatically.</p> <p>The device data specification link will be published to a special topic:</p> <div class="language- extra-class"><pre><code>{user}/{device-id}/tx/TsDataSpec
</code></pre></div><p>If the binary mode is used with separated IDs and values, the IDs should be published with QoS 1 and the retained flag in order to make sure they are always available and matching the values that are sent to the <code>/v/</code> topic.</p> <p>In general, static data like firmware version from the <code>info</code> group should only be published once after startup and may use the retained flag aswell.</p> <h3 id="cloud-to-device"><a href="#cloud-to-device" class="header-anchor">#</a> Cloud to device</h3> <p><strong>JSON name:value map</strong></p> <div class="language- extra-class"><pre><code>{user}/{device-id}/rx/{group-name}
</code></pre></div><p><strong>CBOR id:value map</strong></p> <div class="language- extra-class"><pre><code>{user}/{device-id}/rxb/m/{group-id}
</code></pre></div><p><strong>CBOR ids</strong></p> <div class="language- extra-class"><pre><code>{user}/{device-id}/rxb/i/{group-id}
</code></pre></div><p><strong>CBOR values</strong></p> <div class="language- extra-class"><pre><code>{user}/{device-id}/rxb/v/{group-id}
</code></pre></div><h2 id="request-response"><a href="#request-response" class="header-anchor">#</a> Request / response</h2> <p>For the request / response messaging mode the response has to be matched with the request. For this reason, the request is stored in a topic with an appended request ID chosen by the requesting device. The response will be stored in a topic containing the same ID.</p> <p><strong>Requests (JSON or CBOR)</strong></p> <div class="language- extra-class"><pre><code>{user}/{device-id}/req/{req-id}
</code></pre></div><p><strong>Response (JSON or CBOR, same as request)</strong></p> <div class="language- extra-class"><pre><code>{user}/{device-id}/res/{req-id}
</code></pre></div><p>The above topics contain the entire ThingSet request or response. Hence, both binary or text mode can be used with the same topic.</p> <h2 id="data-processing"><a href="#data-processing" class="header-anchor">#</a> Data Processing</h2> <p>The following diagrams explain the data flow between a device and an MQTT broker.</p> <p>In case of LoRaWAN or CAN where the binary mode with IDs is used, an agent may be installed which subscribes to the binary messages and translates them to the JSON messages which are later on consumed by a higher-level application.</p> <p>This translation can also be done on a local gateway.</p> <p>The mapping of IDs and names can either be retrieved from the device (e.g. via request/response for a device connected via CAN) or it can be stored in a <code>.json</code> file on a server which contains extended information. The detailed specification of this file is still work in progress.</p> <h3 id="device-to-cloud-2"><a href="#device-to-cloud-2" class="header-anchor">#</a> Device to Cloud</h3> <h4 id="mqtt-direct-low-bandwidth-with-agent"><a href="#mqtt-direct-low-bandwidth-with-agent" class="header-anchor">#</a> MQTT direct (low bandwidth, with agent)</h4> <ul><li>e.g. 2G with global SIM card and very low data rate</li> <li>ID mapping by data agent</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Dev       MQTT:bin     Agent       MQTT:txt     Broker
 |                       |                        |
 |                       |                        |
 |     ids (QoS 1)       |                        |
 | --------------------&gt; |                        |
 |    values (QoS 0)     |                        |
 | --------------------&gt; |    objects (QoS 0)     |
 |                       | ---------------------&gt; |
 |                       |                        |
 |         ...           |                        |
 |                       |                        |
 |    values (QoS 0)     |                        |
 | --------------------&gt; |    objects (QoS 0)     |
 |                       | ---------------------&gt; |
</code></pre></div><h4 id="mqtt-direct-sufficient-bandwidth"><a href="#mqtt-direct-sufficient-bandwidth" class="header-anchor">#</a> MQTT direct (sufficient bandwidth)</h4> <ul><li>e.g. LTE with local SIM card</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Dev       MQTT:txt     Broker
 |                        |
 |    objects (QoS 0)     |
 | ---------------------&gt; |
</code></pre></div><h4 id="serial"><a href="#serial" class="header-anchor">#</a> Serial</h4> <div class="language- extra-class"><pre class="language-text"><code>Dev    UART:txt   GW   HTTP:txt   Web App
 |                 |                  |
 |     objects     |                  |
 | --------------&gt; |      objects     |
 |                 | ---------------&gt; |
</code></pre></div><h4 id="can-smart-gateway"><a href="#can-smart-gateway" class="header-anchor">#</a> CAN (smart gateway)</h4> <ul><li>ID mapping and translation between binary and text mode on gateway</li> <li>Preferred way</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Dev     CAN:bin       GW       MQTT:txt       Broker
 |                    |                         |
 |      values        |                         |
 | -----------------&gt; |                         |
 |   req/resp names   |                         |
 | &lt;----------------&gt; |    objects (QoS 0)      |
 |                    | ----------------------&gt; |
 |         ...        |                         |
 |                    |                         |
 |      values        |                         |
 | -----------------&gt; |    objects (QoS 0)      |
 |                    | ----------------------&gt; |
</code></pre></div><h4 id="can-with-data-agent"><a href="#can-with-data-agent" class="header-anchor">#</a> CAN (with data agent)</h4> <ul><li>ID mapping by data agent</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Dev     CAN:bin      GW       MQTT:bin       Agent       MQTT:txt     Broker
 |                   |                         |                        |
 |      values       |                         |                        |
 | ----------------&gt; |                         |                        |
 |   req/resp ids    |                         |                        |
 | &lt;---------------&gt; |     ids (QoS 1)         |                        |
 |                   | ----------------------&gt; |                        |
 |                   |    values (QoS 0)       |                        |
 |                   | ----------------------&gt; |    objects (QoS 0)     |
 |                   |                         | ---------------------&gt; |
 |        ...        |                         |                        |
 |                   |                         |                        |
 |      values       |                         |                        |
 | ----------------&gt; |    values (QoS 0)       |                        |
 |                   | ----------------------&gt; |    objects (QoS 0)     |
 |                   |                         | ---------------------&gt; |
</code></pre></div><h4 id="lorawan-smart-gateway"><a href="#lorawan-smart-gateway" class="header-anchor">#</a> LoRaWAN (smart gateway)</h4> <ul><li>ID mapping on gateway</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Dev   LoRaWAN:bin      GW       MQTT:txt      Broker
 |                     |                        |
 |     ids (ACK-ed)    |                        |
 | ------------------&gt; |                        |
 |       values        |                        |
 | ------------------&gt; |    objects (QoS 0)     |
 |                     | ---------------------&gt; |
 |        ...          |                        |
 |                     |                        |
 |       values        |                        |
 | ------------------&gt; |    objects (QoS 0)     |
 |                     | ---------------------&gt; |
</code></pre></div><h4 id="lorawan-with-data-agent"><a href="#lorawan-with-data-agent" class="header-anchor">#</a> LoRaWAN (with data agent)</h4> <ul><li>Simple forwarding of messages by gateway</li> <li>ID mapping by data agent or statically via TTN payload formatter</li> <li>Probably preferred way in order to be able to use standard TTN gateways</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Dev   LoRaWAN:bin      GW       MQTT:bin     Agent       MQTT:txt     Broker
 |                     |                       |                        |
 |     ids (ACK-ed)    |                       |                        |
 | ------------------&gt; |     ids (QoS 1)       |                        |
 |       values        | --------------------&gt; |                        |
 | ------------------&gt; |    values (QoS 0)     |                        |
 |                     | --------------------&gt; |    objects (QoS 0)     |
 |                     |                       | ---------------------&gt; |
 |        ...          |                       |                        |
 |                     |                       |                        |
 |       values        |                       |                        |
 | ------------------&gt; |    values (QoS 0)     |                        |
 |                     | --------------------&gt; |    objects (QoS 0)     |
 |                     |                       | ---------------------&gt; |
</code></pre></div><h3 id="cloud-to-device-2"><a href="#cloud-to-device-2" class="header-anchor">#</a> Cloud to Device</h3> <h4 id="serial-2"><a href="#serial-2" class="header-anchor">#</a> Serial</h4> <div class="language- extra-class"><pre class="language-text"><code>Dev    UART:txt     GW   MQTT:txt   Web App
 |                  |                  |
 |                  |      objects     |
 |      objects     | &lt;--------------- |
 | &lt;--------------- |                  |
</code></pre></div><h4 id="can-direct"><a href="#can-direct" class="header-anchor">#</a> CAN (direct)</h4> <ul><li>No mapping of IDs needed, as incoming statements are sent via ISO-TP and can have almost arbitrary length.</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Dev     CAN:txt      GW       MQTT:txt       Broker
 |                   |                         |
 |                   |      objects (QoS 0)    |
 |      objects      | &lt;---------------------- |
 | &lt;---------------- |                         |
</code></pre></div><h4 id="lorawan-direct"><a href="#lorawan-direct" class="header-anchor">#</a> LoRaWAN (direct)</h4> <ul><li>ID mapping on gateway</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Dev   LoRaWAN:bin      GW       MQTT:txt      Broker
 |                     |                        |
 |    ids (ACK-ed)     |                        |
 | ------------------&gt; |                        |
 |                     |                        |
 |        ...          |                        |
 |                     |                        |
 |                     |     objects (QoS 0)    |
 |       values        | &lt;--------------------- |
 | &lt;------------------ |                        |
</code></pre></div><h4 id="lorawan-with-data-agent-2"><a href="#lorawan-with-data-agent-2" class="header-anchor">#</a> LoRaWAN (with data agent)</h4> <ul><li>Simple forwarding of messages by gateway</li> <li>ID mapping by data agent or statically via TTN payload formatter</li> <li>Probably preferred way in order to be able to use standard TTN gateways</li></ul> <div class="language- extra-class"><pre class="language-text"><code>Dev   LoRaWAN:bin      GW       MQTT:bin     Agent       MQTT:txt     Broker
 |                     |                       |                        |
 |    ids (ACK-ed)     |                       |                        |
 | ------------------&gt; |     ids (QoS 1)       |                        |
 |       values        | --------------------&gt; |                        |
 | ------------------&gt; |    values (QoS 0)     |                        |
 |                     | --------------------&gt; |    objects (QoS 0)     |
 |                     |                       | ---------------------&gt; |
 |        ...          |                       |                        |
 |                     |                       |                        |
 |       values        |                       |                        |
 | ------------------&gt; |    values (QoS 0)     |                        |
 |                     | --------------------&gt; |    objects (QoS 0)     |
 |                     |                       | ---------------------&gt; |
</code></pre></div><h3 id="cloud-to-device-requests"><a href="#cloud-to-device-requests" class="header-anchor">#</a> Cloud to Device (requests)</h3> <p>ToDo</p> <h2 id="references"><a href="#references" class="header-anchor">#</a> References</h2> <p>[1] <a href="https://d1.awsstatic.com/whitepapers/Designing_MQTT_Topics_for_AWS_IoT_Core.pdf" target="_blank" rel="noopener noreferrer">Designing MQTT Topics for AWS IoT Core<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[2] https://pi3g.com/2019/05/29/mqtt-topic-tree-design-best-practices-tips-examples/</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/4/2021, 11:23:12 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/thingset/branch/v0.4/4b_coap.html" class="prev">
        CoAP
      </a></span> <span class="next"><a href="/thingset/branch/v0.4/5a_serial.html">
        Serial
      </a>
      →
    </span></p></div>  <div class="footer">
    Content provided by <a href="https://libre.solar">Libre Solar</a> under <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">CC-BY-SA 4.0 License</a> | <a href="https://libre.solar/about/contact/">Contact / Impressum</a></div></main></div><div class="global-ui"></div></div>
    <script src="/thingset/branch/v0.4/assets/js/app.7e1b989c.js" defer></script><script src="/thingset/branch/v0.4/assets/js/2.d1779d51.js" defer></script><script src="/thingset/branch/v0.4/assets/js/3.b5a90050.js" defer></script><script src="/thingset/branch/v0.4/assets/js/23.8a8cf15c.js" defer></script>
  </body>
</html>

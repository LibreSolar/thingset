(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{383:function(t,e,a){"use strict";a.r(e);var i=a(42),o=Object(i.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"thingset-to-mqtt-mapping"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#thingset-to-mqtt-mapping"}},[t._v("#")]),t._v(" ThingSet to MQTT mapping")]),t._v(" "),a("p",[t._v("The MQTT protocol doesn't support the request/response part of the ThingSet protocol, but the publish/subscribe messaging pattern can be easily mapped.")]),t._v(" "),a("h2",{attrs:{id:"publication"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#publication"}},[t._v("#")]),t._v(" Publication")]),t._v(" "),a("p",[t._v("The topic used to publish to the MQTT server may contain the path of the data nodes. The topic name itself could be stored as a data node, but it's not relevant to the implementation of publication messages in the ThingSet protocool.")]),t._v(" "),a("p",[t._v('A ThingSet publication message starts with a first byte 0x1F in binary mode or "# " in text mode to indicate a publication message. Whether this byte is also stored in the MQTT topic depends on the application.')]),t._v(" "),a("p",[t._v("If a single measurement value is stored in an MQTT topic (e.g. /devices/device-id/Bat_V for the battery voltage), it is recommended that only the JSON or CBOR payload data is stored in the MQTT payload and the path of the ThingSet endpoint is contained in the topic.")]),t._v(" "),a("p",[t._v("If multiple data nodes are stored in the same topic, the entire ThingSet publication message could be stored to allow direct passing between MQTT topic and ThingSet.")]),t._v(" "),a("h2",{attrs:{id:"subscription"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#subscription"}},[t._v("#")]),t._v(" Subscription")]),t._v(" "),a("p",[t._v("Content fetched from a specific topic is forwarded to the ThingSet protocol as a publication message. The ThingSet device will parse the incoming data similar to a PATCH request. Unknown data nodes contained in the subscribed payload are silently ignored.")]),t._v(" "),a("p",[t._v("If the application requires some processing of incoming data before applying them to actual nodes, temporary data nodes can be created where the subscribed content is written to. Afterwards a function is called (assigned as a callback to the sub channel node) to process the incoming data and pass it on to the actual nodes.")]),t._v(" "),a("p",[t._v("This approach can also be used to determine if the received data has changed compared to already existing state and avoid too many storage operations in EEPROM for regularly published messages.")])])}),[],!1,null,null,null);e.default=o.exports}}]);